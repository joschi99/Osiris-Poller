." Text automatically generated by txt2man
.TH Check_WMI_Plus  "30 January 2016" "" ""
.SH NAME
\fBcheck_wmi_plus.pl \fP- Client-less checking of Windows machines
.SH BRIEF
.TP
.B
Typical Usage:
.PP
check_wmi_plus.pl \fB-H\fP HOSTNAME \fB-u\fP DOMAIN/USER \fB-p\fP PASSWORD [\fB-A\fP AUTHFILE] \fB-m\fP MODE [\fB-s\fP SUBMODE] [\fB-a\fP ARG1 ] [\fB-w\fP WARN] [\fB-c\fP CRIT]
.TP
.B
Complete Usage:
.PP
check_wmi_plus.pl \fB-H\fP HOSTNAME \fB-u\fP DOMAIN/USER \fB-p\fP PASSWORD \fB-m\fP MODE [\fB-s\fP SUBMODE] [\fB-b\fP BYTEFACTOR] [\fB-w\fP WARN] [\fB-c\fP CRIT] [\fB-a\fP ARG1 ] [\fB-o\fP ARG2] [\fB-3\fP ARG3] [\fB-4\fP ARG4] [\fB-5\fP ARG5] [\fB-A\fP AUTHFILE] [\fB-t\fP TIMEOUT] [\fB-y\fP DELAY] [\fB--namespace\fP WMINAMESPACE] [\fB--extrawmicarg\fP EXTRAWMICARG] [\fB--nodatamode\fP] [\fB--nodataexit\fP NODATAEXIT] [\fB--nodatastring\fP NODATASTRING] [\fB-d\fP] [\fB-z\fP] [\fB--inifile\fP=INIFILE] [\fB--inidir\fP=INIDIR] [\fB--inihelp\fP] [\fB--nokeepstate\fP] [\fB--keepexpiry\fP KEXPIRY] [\fB--keepid\fP KID] [\fB--joinexpiry\fP JEXPIRY] [\fB-v\fP OSVERSION] [\fB--help\fP] [\fB--itexthelp\fP] [\fB--forcewmiccommand\fP] [\fB-icollectusage\fP] [\fB--ishowusage\fP] [\fB--logswitch\fP] [\fB--logkeep\fP] [\fB--logsuffix\fP SUFFIX] [\fB--logshow\fP] [\fB--variablesdisabled\fP] [\fB--forceiniopen\fP] [\fB--forcetruncateoutput\fP LEN] [\fB--Mapexit\fP MAPSPEC] [\fB--fieldshow\fP]
.TP
.B
Help as a Manpage:
.PP
check_wmi_plus.pl \fB--help\fP
.TP
.B
Help as Text:
.PP
check_wmi_plus.pl \fB--itexthelp\fP (its very long!)
.SH DESCRIPTION
check_wmi_plus.pl is a client-less Nagios plugin for checking Windows systems.
No more need to install any software on any of your Windows machines. Check directly from your Nagios server.
Check WMI Plus uses the Windows Management Interface (WMI) to check for common services (cpu, disk, sevices, eventlog\.\.\.) on Windows machines. It requires the open source wmi client for Linux (wmic).
.PP
Besides the built in checks, Check WMI Plus functionality can be easily extended through the use of ini files. Check WMI Plus comes with several ini files, but you are free to add your own checks to your own ini file. 
.PP
For more information see the website www.edcint.co.nz/checkwmiplus
.SH REQUIRED OPTIONS
.TP
.B
\fB-H\fP HOSTNAME
specify the name or IP Address of the host that you want to check
.RE
.PP
You must specifiy a username/password/domain in one of two ways. The use of \fB-u\fP DOMAIN/USER \fB-p\fP PASSWORD always overrides the values contained in \fB-A\fP AUTHFILE
.RS
.TP
.B
\fB-u\fP DOMAIN/USER
specify the DOMAIN (optional) and USER that has permission to execute WMI queries on HOSTNAME
.TP
.B
\fB-p\fP PASSWORD
the PASSWORD for USER
.TP
.B
\fB-A\fP AUTHFILE
the full path to an authentication file. The file is passed directly to /bin/wmic. Check WMI PLus does not read the file and hence you must get the file format as required by /bin/wmic. You can override the settings in this file by using \fB-u\fP DOMAIN/USER \fB-p\fP PASSWORD.
.PP
.nf
.fam C
       Authentication File format is
         username=USERNAME  
         password=PASSWORD  
         domain=DOMAIN  

       Set your own values for USERNAME, PASSWORD and DOMAIN. DOMAIN may be nothing.

.fam T
.fi
.TP
.B
\fB-m\fP MODE
the check mode. The list of valid MODEs and a description is shown below
.SH COMMONLY USED OPTIONS
.TP
.B
\fB-s\fP SUBMODE
the submode. Some MODEs have one or more submodes. These are also described below.
.TP
.B
\fB-a\fP ARG1
argument number 1. Its meaning depends on the MODE/SUBMODE combination.
.TP
.B
\fB-o\fP ARG2
argument number 2. Its meaning depends on the MODE/SUBMODE combination.
.TP
.B
\fB-3\fP ARG3
argument number 3. Its meaning depends on the MODE/SUBMODE combination.
.TP
.B
\fB-4\fP ARG4
argument number 4. Its meaning depends on the MODE/SUBMODE combination.
.TP
.B
\fB-5\fP ARG5
argument number 5. Its meaning depends on the MODE/SUBMODE combination.
.TP
.B
\fB-w\fP WARN
specify warning criteria. You can specify none, one or more criteria. If any one of the criteria is triggered then the plugin will exit with a warning status (unless a critical status is also triggered). See below for how to specify warning criteria.
.TP
.B
\fB-c\fP CRIT
specify critical criteria. You can specify none, one or more criteria. If any one of the criteria is triggered then the plugin will exit with a critical status. See below for how to specify warning criteria.
.SH LESS COMMONLY USED OPTIONS
.TP
.B
\fB-b\fP BYTEFACTOR
BYTEFACTOR is either 1000 or 1024 and is used for conversion units eg bytes to GB. Default is 1024.
.TP
.B
\fB-t\fP TIMEOUT
specify the number of seconds before the plugin will timeout. Some WMI queries take longer than others and network links with high latency may also require you to increase this from the default value of 15
.TP
.B
\fB--includedata\fP DATASPEC
specify data values that are to be included. See the section below on INCLUDING AND EXCLUDING WMI DATA
.TP
.B
\fB--excludedata\fP DATASPEC
specify data values that are to be excluded. See the section below on INCLUDING AND EXCLUDING WMI DATA
.TP
.B
\fB--nodatamode\fP
Controls how the plugin responds when no data is returned by the WMI query. Normally, when no data is returned from the WMI query, the plugin returns an Unknown error. If you specify this option, then no data is not an error condition anymore and you can use WARN/CRIT checking on the _ItemCount field. This is only useful for some checks eg checkfilesize where you might get no data back from the WMI query when the file is not found, but getting no data back is not an error.
.TP
.B
\fB--nodataexit\fP NODATAEXIT
specify the plugin status result if the WMI Query returns no data. Ignored if \fB--nodatamode\fP is set. Valid values are 0 for OK, 1 for Warning, 2 for Critical (Default) or 3 for Unknown. Only used for some checks. All checks from the ini file can use this.
.TP
.B
\fB--nodatastring\fP NODATASTRING
specify the string that tha plugin will display if the WMI Query returns no data. Ignored if \fB--nodatamode\fP is set. Only used for some checks where the use of NODATAEXIT is valid. All checks from the ini file can use this.
.TP
.B
\fB-y\fP DELAY
Specify the delay between 2 consecutive WMI queries that are run in a single call to the plugin. Defaults are set for certain checks. Only valid if \fB--nokeepstate\fP used.
.TP
.B
\fB--namespace\fP WMINAMESPACE
Specify the WMI Namespace. eg root/MicrosoftDfs. The default is root/cimv2. Use '/' (forward slash) instead of '\\' (backslash).
.TP
.B
\fB--extrawmicarg\fP EXTRAWMICARG
Specify additional arguments to be passed to the wmic command. The arguments are passed directly and must be complete and understood by wmic. In order to assist with escaping of quotes, all # are translated to ". To pass \fB--option\fP="client ntlmv2 auth"=Yes to wmic specifiy \fB--extrawmicarg\fP "\fB--option\fP=#client ntlmv2 auth#=Yes". This option can be specified multiple times to pass multiple arguments to wmic. If you are using the conf file setting for extra wmic arguments then any options specified here are added to the ones specified in the conf file.
.TP
.B
\fB--inihelp\fP
Show the help from the INIFILE for the specified MODE/SUBMODE. If specified without MODE/SUBMODE, this shows a quick short summary of all valid MODE/SUBMODEs in the ini files.
.TP
.B
\fB--inifile\fP=INIFILE
INIFILE is the full path of an ini file to use. The use of \fB--inidir\fP is preferred over this option.
.TP
.B
\fB--inidir\fP=INIDIR
INIDIR is the full path of an ini directory to use. The plugin reads files ending in .ini in INIDIR in the default directory order. The INIFILE is read first, if defined, then each .ini file found in INIDIR. Ini files read later merge with earlier ini files. For any settings that exist in one or more files, the last one read is set.
.TP
.B
\fB--nokeepstate\fP
disables the default mode of keeping state between plugin runs.
.TP
.B
\fB--keepexpiry\fP KEXPIRY
KEXPIRY is the number of seconds after which the plugin assumes that the previously collected data has expired. The default is 3600 sec. You should run your plugin more frequently than this value or set KEXPIRY higher.
.TP
.B
\fB--keepid\fP KID
KID is a unique identifier. This is normally not needed. In order to keep state between plugin runs, the data is written to a file. In order to stop collisions between different plugin runs, and hence incorrect calculations,  the filename is unique based on the checkmode, hostname, arguments passed etc. If for some reason these are not sufficient and you are experiencing collisions, you can add a unique KID to each plugin check to ensure uniqueness.
.TP
.B
\fB--joinexpiry\fP JEXPIRY
JEXPIRY is the number of seconds after which the plugin assumes that the previously collected join data has expired. The default is 3600 sec. Join data that is defined as being reasonably static by whomever created the check will only get refreshed every JEXPIRY seconds.
.TP
.B
\fB-z\fP
Provide full specification warning and critical values for performance data. Not all performance data processing software can handle this eg PNP4Nagios. If this is used with \fB-d\fP then usernames and passwords will be shown rather than being masked (useful if you want to cut and paste the exact wmic command for testing).
.TP
.B
\fB-d\fP
Enable debug. Use this to see a lot more of what is going on including the exact WMI Query and results. User/passwords should be masked in the resulting output unless \fB-z\fP is specified.
.TP
.B
\fB--forcewmiccommand\fP
Force the use of the wmic binary instead of using the WMI Client library. The WMI Client library is used automatically (since it is faster) if it is available on the host running check_wmi_plus. You can tell if you are using the library or the binary wmic by examining the output of \fB-d\fP.
.TP
.B
\fB--ishowusage\fP
Pro Version only. Show usage stats in plugin output.
.TP
.B
\fB--icollectusage\fP
Pro Version only. Collect usage stats.
.TP
.B
\fB--logswitch\fP
Pro Version only. Switch usage DB file.
.TP
.B
\fB--logkeep\fP
Pro Version only. do not remove the Usage DB file you are switching to.
.TP
.B
\fB--logsuffix\fP SUFFIX
Pro Version only. Switch to the Usage DB file using SUFFIX.
.TP
.B
\fB--logshow\fP
Pro Version only. Show current Usage DB file.
.TP
.B
\fB--variablesdisabled\fP
Disable the use of static variables (from the ini files).
.TP
.B
\fB--forceiniopen\fP
Force reading of the ini files. You may want to do this if you are doing a non-ini file check and you are using global variables defined in an ini file. Only use this if you really need it since it makes each invocation of the plugin a lot slower (unless you are doing an ini file check already).
.TP
.B
\fB--forcetruncateoutput\fP LEN
Restrict the length of the plugin output to LEN bytes. The default value is 8192.
.TP
.B
\fB--Mapexit\fP MAPSPEC
Pro Version only. Change the exit code plugin would normally use based on MAPSPEC. MAPSPEC format is one of X:Y or X:Y:REGEX, where X is the original exit code and Y is the new exit code. If REGEX is specified then the exit code mapping is only done if the plugin output matches the case insensitive regular expression REGEX. Multiple \fB--Mapexit\fP parameters can be specified. Order is important as the first one that matches will be used.
.TP
.B
\fB--fieldshow\fP
Show the list of fields available/used for a specific check. Run the check normally and add this option. The list of fields will be shown above the plugin output. This is useful when configuring checks. It shows all the fields available for the specific check. For example, use it to show which fields you can use for \fB--includedata\fP etc 
.SH KEEPING STATE
This only applies to checks that need to perform 2 WMI queries to get a complete result eg checkcpu, checkio, checknetwork etc. Keeping State is used by default.
.PP
Checks like this take 2 samples of WMI values (with a DELAY in between) and then calculate a result by differencing the values. By default, the plugin will "keepstate", which means that 1 WMI sample will be collected each time the plugin runs and it will calculate the difference using the values from the previous plugin run. For something like checkcpu, this means that the plugin gives you an average CPU utilisation between runs of the plugin. Even if you are 0% utilisation each time the plugin runs but 100% in between, checkcpu will still report a very high utilisation percentage. This makes for a very accurate plugin result. Another benefit of keeping state is that it results in fewer WMI queries and the plugin runs faster. If you disable keeping state, then, for these types of checks, the plugin reverts to taking 2 WMI samples with a DELAY each time it runs and works out the result then and there. This means that, for example, any CPU activity that happens between plugin runs is never detected.
.PP
There are some specific state keeping options: 
\fB--nokeepstate\fP, 
\fB--keepexpiry\fP KEXPIRY, 
\fB--keepid\fP KID, 
.PP
The files used to keep state are stored in /tmp. The DELAY setting is not applicable when keeping state is used. If you are "keeping state" then one of the first things shown in the plugin output is the sample period.
.RE
.PP

.SH INI FILE SPECIFIED
There is an ini file/dir configured. The ini files contain more checks. \fB--inihelp\fP on its own shows a one line summary of all MODES/SUBMODES contained within the ini files. \fB--inihelp\fP specified with a MODE/SUBMODE shows the help just for that mode. All of the inihelp is also shown at the end of this help text.
.RE
.PP


.SH INCLUDING AND EXCLUDING WMI DATA
The \fB--includedata\fP and \fB--excludedata\fP options modify the data returned from the WMI query to include/exclude only data that matches DATASPEC. DATASPEC is in the same format as warning/critical specifications (See Section WARNING AND CRITICAL SPECIFICATION).
.PP
At the moment this is largely enabled for checks from ini files and it typically does not apply to the built-in modes. All includes/excludes defined on the command line and the ini file are combined and then processed.
PRO users can use this for the following inbuilt modes: checkdrivesize, checkgroup, checklogon, checknetwork, checkpage, checkprintjob, checkprocess, checkservice, checkshare, checksmart, checkstartupcommand, checkuseraccount, checkvolsize.
PRO users can use regular expressions as as warning/critical specifications hence increasing the power of this option.
.PP
Any fields that are returned by the WMI query can be used, not just the ones that are displayed. Use the \fB--fieldshow\fP option to show the valid fields for a specific check. You might need to use the debug mode (\fB-d\fP) to see all the valid fields available.
.PP
The include/exclude arguments can be specified multiple times on the command line. 
.PP
If \fB--includedata\fP is not used, all data is included.
If any of the inclusions are met the data is included. If any of the exclusions are met then the data is excluded. Inclusions are processed before Exclusions. 
.PP
This can be useful to reduce the length of the output for certain checks or to focus on more important data eg on processes using more than 5% of the CPU rather than the potentially hundreds that are using less than 5%.
.PP
Examples using \fB-m\fP checkproc \fB-s\fP cpu:
.PP
\fB--inc\fP IDProcess=@2000:3000 to include all process IDs that are inside the range of 2000 to 3000.
.PP
\fB--exc\fP _AvgCPU=@0:5 to exclude all processes where the average CPU utilisation is inside the range of 0 to 5.
.PP
Examples using \fB-m\fP checkdrivesize (PRO only):
.PP
\fB--excludedata\fP DeviceID=~'F:|e:' to exclude drives matching F: or E:
.SH WARNING AND CRITICAL SPECIFICATION

If warning or critical specifications are not provided then no checking is done and the check simply returns the value and any related performance data. If they are specified then they should be formatted as shown below.
.PP
Warning and Critical criteria can be specified as a RANGE or as a regular expression (Pro version only).
.SS RANGES
A RANGE is defined as a start and end point (inclusive) on a numeric scale (possibly negative or positive infinity). The theory is that the plugin will do some sort of check which returns back a numerical value, or metric, which is then compared to the warning and critical thresholds. 
.PP
Multiple warning or critical specifications can be specified. This allows for quite complex range checking and/or checking against multiple FIELDS (see below) at one time. The warning/critical is triggered if ANY of the warning/critical specifications are triggered.
.PP
If a ini file check returns multiple rows eg checkio logical, criteria are applied to ALL rows and any ONE row meeting the criteria will cause a trigger. If the check has been defined properly it will show which row/instance triggered the criteria as well as the overall result.
.PP
This is the generalised format for ranges:
FIELD=[@]start:end
.PP
The convention used for field names in this plugin is as follows:
.RS
.IP \(bu 3
FIELDs that start with _ eg _Used% are calculated or derived values
.IP \(bu 3
FIELDs that are all lower case are command line arguments eg _arg1
.IP \(bu 3
Other FIELDs eg PacketsSentPersec are what is returned from the WMI Query
.SS NOTES
.IP 1. 4
FIELD describes which value the specification is compared against. It is optional (the default is dependent on the MODE).
.IP 2. 4
start <= end
.IP 3. 4
start and ":" is not required if start=0
.IP 4. 4
if range is of format "start:" and end is not specified, assume end is infinity
.IP 5. 4
to specify negative infinity, use "~"
.IP 6. 4
alert is raised if metric is outside start and end range (inclusive of endpoints)
.IP 7. 4
if range starts with "@", then alert if inside this range (inclusive of endpoints)
.IP 8. 4
The start and end values can use multipliers from the following list:
or the time-based multipliers .
The time-based multipliers are normally used where the data is in seconds.
eg 1G for 1 x 10^9 or 2.5k for 2500
eg 1wk for 1 week, 3.5day for 3.5 days etc
.SS EXAMPLE RANGES
This table lists example WARN/CRIT criteria and when they will trigger an alert.
.TP
.B
10
< 0 or > 10, (outside the range of {0 .. 10})
.TP
.B
10:
< 10, (outside {10 .. infinity})
.TP
.B
~:10
> 10, (outside the range of {\fB-infinity\fP .. 10})
.TP
.B
10:20
< 10 or > 20, (outside the range of {10 .. 20})
.TP
.B
@10:20
>=10 and <=20, (inside the range of {10 .. 20})
.TP
.B
10G
< 0 or > 10G, (outside the range of {0 .. 10G})
.SS EXAMPLES WITH FIELDS
for MODE=checkdrivesize:
.TP
.B
_UsedGB=10
Check if the _UsedGB field is < 0 or > 10,  (outside the range of {0 .. 10}) 
.TP
.B
_Used=10G
Check if the _Used field is   < 0 or > 10G, (outside the range of {0 .. 10G}) 
.TP
.B
10
Check if the _Used% field is  < 0 or > 10,  (outside the range of {0 .. 10}), no field specified since _Used% is the default
.TP
.B
_Used%=10
Check if the _Used% field is  < 0 or > 10,  (outside the range of {0 .. 10}) 
.SS EXAMPLES WITH MULITPLE SPECIFICATIONS
for MODE=checkdrivesize:
.TP
.B
\fB-w\fP _UsedGB=10 \fB-w\fP 15 \fB-w\fP _Free%=5: \fB-c\fP _UsedGB=20 \fB-c\fP _Used%=25
This will generate a warning if 
.RS
.IP \(bu 3
the Used GB on the drive is more than 10 or
.IP \(bu 3
the used % of the drive is more than 15% or
.IP \(bu 3
the free % of the drive is less than 5%
.RE
.PP
This will generate a critical if 
.RS
.IP \(bu 3
the Used GB on the drive is more than 20 or
.IP \(bu 3
the used % of the drive is more than 25%
.SS REGULAR EXPRESSIONS
This is the generalised format for a regular expression (Pro version only):
.TP
.B
FIELD=~REGEX
(for testing if the value of the FIELD matches the REGEX)
or
.TP
.B
FIELD=!~REGEX
(for testing if the value of the FIELD does not match the REGEX)
.PP
Note that as for the definition of RANGES (see section above for more details)
.RS
.IP \(bu 3
the same naming conventions for FIELD names apply.
.IP \(bu 3
specification of the FIELD is optional (in which case the format is ~REGEX or !~REGEX) and the default FIELD is dependent on the MODE.
.SH BUILTIN MODES
The following modes are coded directly into the plugin itself and do not require any ini files to function.
.PP
Each mode describes the optional arguments and parameters valid for use with that MODE.
.TP
.B
checkcpu
Some CPU checks just take whatever WMI or SNMP gives them from the precalculated values. We don't.
We use WMI Raw counters to calculate values over a given timeperiod. This is much more accurate than taking Formatted WMI values.
.RS
.TP
.B
DELAY
(optional) specifies the number of seconds over which the utilisation is calculated. The longer you can make this without timing out, the more accurate it will be. If specifying longer values. You may also need to use the \fB-t\fP parameter to set a longer script timeout. Only valid if also specifying \fB--nokeepstate\fP ie you are not using the state keeping feature. We recommend that you do keep state and hence do not use \fB--nokeepstate\fP.
.TP
.B
WARN/CRIT
can be used as described below.
The only valid Warning/Critical Field is _AvgCPU, so you don't even need to specify it!.
.RE
.RE
.TP
.B
checkcpuq
The WMI implementation of CPU Queue length is a point value.
We try and improve this slightly by performing several checks and averaging the values.
.RS
.TP
.B
ARG1
(optional) specifies how many point checks are performed. Default 3.
.TP
.B
DELAY
(optional) specifies the number of seconds between point checks. Default 1. It can be 0 but in reality there will always be some delay between checks as it takes time to perform the actual WMI query 
.TP
.B
WARN/CRIT
can be used as described below.
The only valid Warning/Critical Field is _AvgCPUQLen, so you don't even need to specify it!.
.PP
Note: Microsoft says "A sustained processor queue of greater than two threads generally indicates
processor congestion.". However, we recommended testing your warning/critical levels to determine the
optimal value for you.
.RE
.TP
.B
checkdrivesize
By default, drives in a non-OK state will be shown first.
Also see checkvolsize
.RS
.TP
.B
ARG1
drive letter or volume name of the disk to check. If omitted a list of valid drives will be shown. If set to . all drives will be included.
To include multiple drives separate them with a |. This uses a regular expression so take care to
specify exactly what you want. eg "C" or "C:" or "C|E" or "." or "Data"
.TP
.B
ARG2
Set this to 1 to use volumes names (if they are defined) in plugin output and performance data ie \fB-o\fP 1
.TP
.B
ARG3
Set this to 1 to include information about the sum of all disk space on the entire system.
If you set this you can also check warn/crit against the overall disk space.
To show only the overall disk, set ARG3 to 1 and set ARG1 to 1 (actually to any non-existant disk)
Eg \fB-o\fP 1 \fB-3\fP 1
.TP
.B
ARG4
This is a 2 character string which controls how the drive information is displayed. 
.PP
.nf
.fam C
       Format is XY where
         X=0, display not-ok drives first
         X=1, display drives in the order the the WMI query returns them in
         X=2, only display not-ok drives
         X=3, If all drives are OK, same display as X=1. If there are any not OK drives, same display as X=2
         Y=0, show results on a single line
         Y=1, show results as multi-line with the first line being a high level summary of status 

.fam T
.fi
.TP
.B
WARN/CRIT
can be used as described below.
Valid Warning/Critical Fields are: _Used% (Default), _UsedSpace, _UsedGB, _Free%, FreeSpace_FreeGB.
.PP
PRO Users can use \fB--includedata\fP and \fB--excludedata\fP for this mode. Note that, if using ARG3, and these options, the system totals may be misleading.
.RE
.TP
.B
checkeventlog
.RS
.TP
.B
ARG1
Name of the log eg "System" or "Application" or any other Event log as shown in the Windows "Event Viewer". You may also use a comma delimited list to specify multiple event logs. You can also specify event log names using the wildcard character % eg system,app%,%shell%. Default is system
.TP
.B
ARG2
A comma delimited list of severity numbers. If not specfied this defaults to 1. If only one level is specified, all severity levels less than and equal to it are included. If more than one is specified then only those levels are included. To include only a single level, put a comma before the severity number eg ,3.
.PP
.nf
.fam C
       The severity levels available are:  
       5 = Security Audit Failure.
       4 = Security Audit Success
       3 = Information
       2 = Warning
       1 = Error

.fam T
.fi
.TP
.B
ARG3
Number of past hours to check for events. Default is 1
.TP
.B
ARG4
Comma delimited list of ini file sections to get extra settings from. Default value is eventdefault.
ie use the eventdefault section settings from the ini file. The ini file contains regular expression based inclusion
and exclusion rules to accurately define the events you want to or don't want to see. Event inclusions and exlusions rules are ANDed together. See the events.ini file for details.
.TP
.B
ARG5
The Include/Exclude mode. Defaults to 'any', which includes event log records that match any of the match criteria. PRO users can additionally specify 'includeall' which will only include event log records that match all the match criteria.
.TP
.B
WARN/CRIT
can be used as described below.
The only valid Warning/Critical Field is _ItemCount, so you don't even need to specify it!.
.TP
.B
Examples:
to report all errors (1) that got logged in the past 24 hours in the System event log use:
.RS
.PP
\fB-a\fP System \fB-3\fP 24
.PP
to report all errors (1) that got logged in the past 24 hours in any event log use:
.PP
\fB-a\fP % \fB-3\fP 24
.PP
to report all warnings (2) and errors (1) that got logged in the past 4 hours in the Application event log use:
.PP
\fB-a\fP application \fB-o\fP 2 \fB-3\fP 4 OR \fB-a\fP application \fB-o\fP 1,2 \fB-3\fP 4
.PP
to report all information (3) and errors (1) that got logged in the past 4 hours in the Application event log use:
.PP
\fB-a\fP application \fB-o\fP 1,3 \fB-3\fP 4
.PP
to report only Security Audit Failure (5) events that got logged in the past 4 hours in any event log use:
.PP
\fB-a\fP % \fB-o\fP ,5 \fB-3\fP 4
.PP
to report your custom mix of event log messages from the system event log use (the names passed to this argument are ini sections defined in an ini file eg event.ini):
.PP
\fB-4\fP eventinc_1,eventinc_2,eventinc_3,eventexclude_1
.RE
.RE
.TP
.B
checkfileage
.RS
.TP
.B
ARG1
full path to the file. Use '/' (forward slash) instead of '\\' (backslash).
.TP
.B
ARG2
set this to one of the time multipliers ()
This becomes the display unit and the unit used in the performance data. Default is hr.
\fB-z\fP can not be used for this mode.
.TP
.B
WARN/CRIT
can be used as described below.
The only valid Warning/Critical Field is _FileAge, so you don't even need to specify it!
.RS
.PP
The warning/critical values should be specified in seconds. However you can use the time multipliers
() to make it easier to use
.PP
eg instead of putting \fB-w\fP 3600 you can use \fB-w\fP 1hr
.PP
eg instead of putting \fB-w\fP 5400 you can use \fB-w\fP 1.5hr
.PP
Typically you would specify something like \fB-w\fP 24: \fB-c\fP 48:
.RE
.RE
.TP
.B
checkfilesize
.RS
.TP
.B
ARG1
full path to the file. Use '/' (forward slash) instead of '\\' (backslash).
eg "C:/pagefile.sys" or "C:/windows/winhlp32.exe"
.TP
.B
NODATAEXIT
can be set for this check.
.TP
.B
WARN/CRIT
can be used as described below.
If you specify \fB--nodatamode\fP then you can use WARN/CRIT checking on the _ItemCount. _ItemCount should only ever be 0 or 1.
This allows you to control how the plugin responds to non-existant files.
Valid Warning/Critical Fields are: FileSize (Default), _ItemCount.
.RE
.TP
.B
checkfoldersize
WARNING - This check can be slow and may timeout, especially if including subdirectories. 
It can overload the Windows machine you are checking. Use with caution.
.RS
.TP
.B
ARG1
full path to the folder. Use '/' (forward slash) instead of '\\' (backslash). eg "C:/Windows"
.TP
.B
ARG4
Set this to s to include files from subdirectories eg \fB-4\fP s
.TP
.B
NODATAEXIT
can be set for this check.
.TP
.B
WARN/CRIT
can be used as described below.
If you specify \fB--nodatamode\fP then you can use WARN/CRIT checking on the _ItemCount. _ItemCount should only ever be 0 or 1.
This allows you to control how the plugin responds to non-existant files.
Valid Warning/Critical Fields are: _FolderSize (Default), _ItemCount.
.RS
.IP \(bu 3

checkgroup
.RE
.TP
.B
WARN/CRIT
can be used as described below.
Valid Warning/Critical Fields are: _ItemCount (Default), _ItemChange, LocalAccount, Status
.TP
.B
Note:
Use \fB--nodatamode\fP and/or NODATAEXIT settings to control what happens if no matching groups are found.
.PP
PRO Users can use \fB--includedata\fP and \fB--excludedata\fP for this mode. Eg \fB--incl\fP LocalAccount=~true.
The groups are defined as changed if the fields shown in the plugin output change between runs.
Check for changes by using \fB-w\fP _ItemChange=~true.
.RE
.PP
checkgroupuser
.RS
.TP
.B
WARN/CRIT
can be used as described below.
Valid Warning/Critical Fields are: _ItemCount (Default), _ItemChange
.TP
.B
Note:
Use \fB--nodatamode\fP and/or NODATAEXIT settings to control what happens if no matching group users are found.
.PP
PRO Users can use \fB--includedata\fP and \fB--excludedata\fP for this mode. Eg \fB--incl\fP _GroupName=~admin.
The group users are defined as changed if the fields shown in the plugin output change between runs.
Check for changes by using \fB-w\fP _ItemChange=~true.
.RE
.PP
checklogon (PRO only)
.RS
.TP
.B
WARN/CRIT
can be used as described below.
Valid Warning/Critical Fields are: _ItemCount (Default), _ItemChange
.TP
.B
Note:
Use \fB--nodatamode\fP and/or NODATAEXIT settings to control what happens if no matching logons are found.
.PP
PRO Users can use \fB--includedata\fP and \fB--excludedata\fP for this mode. Eg \fB--incl\fP _LogonTypeDescription=~interactive.
Check for changes by using \fB-w\fP _ItemChange=~true.
_LogonTypeDescriptions are available from https://msdn.microsoft.com/en-us/library/windows/desktop/aa394189%28v=vs.85%29.aspx. Commonly used values are Interactive, System and Network
.TP
.B
Note:
This check uses 2 WMI queries per run to collect all the required information. It is possible that logged on users change between these 2 queries eg the user logging in to perform the WMI query and so you may end up with some incomplete information. If you want to exclude these records, include only data with has a LogonId by adding \fB--incl\fP LogonId=~.
.RE
.TP
.B
checkmem
This mode checks the amount of physical RAM in the system.
.RS
.TP
.B
WARN/CRIT
can be used as described below.
Valid Warning/Critical Fields are: _MemUsed% (Default), _MemFree%, _MemUsed, _MemFree, _MemTotal.
.RE
.TP
.B
checknetwork
These network checks use WMI Raw counters to calculate values over a given timeperiod. 
This is much more accurate than taking Formatted WMI values.
.RS
.TP
.B
ARG1
Specify the network interface the stats are collected for.  If set to . all interfaces will be included.
To include multiple interfaces separate them with a | or specify a common identifier eg part of an IP Address or MAC Address. This uses a regular expression so take care to
specify exactly what you want. eg "LAN0" or "192.168.0.1" or "192.168.0" or "LAN0|LAN2" or "." or "08:00:27:85:CE:6D" or "08:00:27"
To specify a network interface you can use either the Connection Name (as seen in Control Panel), IP Address (IPv4 or IPV6) or MAC Address. You can also use the name of the network adaptors as seen from WMI which is similar to what is seen in the output of the ipconfig/all command on Windows. However, it is not exactly the same and can be tricky since this uses a regular expression. Run without \fB-a\fP to show the interface
names, IP Addresses, MAC Addresses. Typically you need to use '' around the adapter name when specifying.
.TP
.B
DELAY
(optional) specifies the number of seconds over which the utilisation is calculated. The longer you can make this without timing out, the more accurate it will be. If specifying longer values. You may also need to use the \fB-t\fP parameter to set a longer script timeout. Only valid if also specifying \fB--nokeepstate\fP ie you are not using the state keeping feature. We recommend that you do keep state and hence do not use \fB--nokeepstate\fP.
.TP
.B
WARN/CRIT
can be used as described below.
Valid Warning/Critical Fields are: CurrentBandwidth (Default), _PacketsSentPersec, _PacketsReceivedPersec, OutputQueueLength, PacketsReceivedErrors, _BytesSentPersec, _BytesReceivedPersec, _SendBytesUtilisation, _ReceiveBytesUtilisation
.TP
.B
BYTEFACTOR
defaults to 1000 for this mode. You can override this if you wish.
.TP
.B
Note:
This check does up to 3 WMI queries so it may be slow. You might need to use the \fB-t\fP option. Since 2 of the WMI queries are relatively static, their results are cached and you can set the refresh period for this data using \fB--joinexpiry\fP.
.PP
PRO Users can use \fB--includedata\fP and \fB--excludedata\fP for this mode.
.RE
.TP
.B
checkpage
This mode checks the amount of page file usage.
The total page file size varies between the Initial size and the Maximum Size you set in Windows.
.RS
.TP
.B
ARG1
Set this to "auto" to automatically set warning/critical levels. The warning level is set to the same as the
inital size of the page file. The critical level is set to 80% of the maximum page file size.
If set, it is used instead of any command line specification of warning/critical settings.
Note: The separate WMI query to obtain the additional information required to use this setting only works if you have set a custom size for your page files. If they are set to "System Managed", this will not work. You can tell if an automatic warning/critical level has been set by examining the performance data for the "Used" value. In this example - "'E:/pagefile.sys Used'=41943040Bytes;104857600;167772160;" you can tell that the levels have been automatically set because there are 3 numeric values in the performance data - the last 2 are the warning and critical levels.
.TP
.B
ARG2
drive letter page to check. If omitted all page files will be included.
To include multiple drives separate them with a |. This uses a regular expression so take care to
specify exactly what you want. eg "C:" or "C:|E:". Make sure you use a : after each drive letter to match properly.
.TP
.B
ARG3
Set this to 1 to include information about the sum of all pages file on the entire system.
If you set this you can also check warn/crit against the overall disk space.
To show only the overall page file info, set ARG3 to 1 and set ARG2 to 1 (actually to any non-existant disk)
Eg \fB-o\fP 1 \fB-3\fP 1
.TP
.B
ARG4
Set this to 1 to add the RAM values to the Page file values. This option automatically disables the use of ARG1 and ARG2 and automatically sets ARG3 to show only the system totals. The display is simplified to show only Used, Free and Total amounts.
Eg \fB-4\fP 1
.TP
.B
WARN/CRIT
can be used as described below.
Valid Warning/Critical Fields are: _Used% (Default), _Used, _Free, _Free%, _PeakUsed%, _PeakUsed, _PeakFree, _PeakFree%, _Total.
.TP
.B
Note:
This check does up to 2 WMI queries (if \fB-a\fP auto or ARG4 is used) so it may be slow. You might need to use the \fB-t\fP option. Since 1 of the WMI queries (for \fB-a\fP auto) is relatively static, its results are cached and you can set the refresh period for this data using \fB--joinexpiry\fP.
.PP
PRO Users can use \fB--includedata\fP and \fB--excludedata\fP for this mode.
.RE
.PP
checkprintjob (PRO only)
.RS
.TP
.B
WARN/CRIT
can be used as described below.
Valid Warning/Critical Fields are: _ItemCount (Default), _ItemChange, Color, Status, TotalPages, Owner, Document, DataType
.TP
.B
Note:
Use \fB--nodatamode\fP and/or NODATAEXIT settings to control what happens if no matching jobs are found.
.PP
PRO Users can use \fB--includedata\fP and \fB--excludedata\fP for this mode. Eg \fB--incl\fP _PrintJob=~laser.
The print queue is defined as changed if the fields shown in the plugin output change between runs.
Check for changes by using \fB-w\fP _ItemChange=~true.
.RE
.TP
.B
checkprocess
.RS
.TP
.B
SUBMODE
Set this to Name, ExecutablePath, or Commandline to determine if ARG1 and ARG3 matches against just the
process name (Default), the full path of the executable file, or the complete command line used to run the process.
.TP
.B
ARG1
A regular expression to match against the process name, executable path or complete command line.
The matching processes are included in the resulting list. Use . alone to include all processes. Typically the process
.RS
.IP \(bu 3
Executable Path is like DRIVE:PATH/PROCESSNAME eg C:/WINDOWS/system32/svchost.exe,
.IP \(bu 3
Command Line is like DRIVE:PATH/PROCESSNAME PARAMETERS eg C:/WINDOWS/system32/svchost.exe \fB-k\fP LocalService
Use '/' (forward slash) instead of '\\' (backslash). eg "C:/Windows" or "C:/windows/system32"
Note: Any '/' in your regular expression will get converted to '\\'.
.RE
.TP
.B
ARG2
Set this to 'Name' (Default), Executablepath or 'Commandline' to display the process names, executablepath or the 
whole command line.
.TP
.B
ARG3
A regular expression to match against the process name, executable path or complete command line.
The matching processes are excluded from the resulting list. This exclusion list is applied after the inclusion list.
.PP
For SUBMODE and ARG2 you only need to specify the minimum required to make it unique. Any of the following will work
\fB-s\fP e, \fB-s\fP exe, \fB-s\fP c, \fB-s\fP com, \fB-o\fP e, \fB-o\fP exe, \fB-o\fP c, \fB-o\fP com
.TP
.B
WARN/CRIT
can be used as described below.
Valid Warning/Critical Fields are: _ItemCount (Default), _NumExcluded
.PP
PRO Users can use \fB--includedata\fP and \fB--excludedata\fP for this mode.
.RE
.PP
checkquota (PRO only)
.RS
.TP
.B
WARN/CRIT
can be used as described below.
Valid Warning/Critical Fields are: _ItemCount (Default), _ItemChange, DiskSpaceUsed, Limit, Status, WarningLimit
.TP
.B
Note:
Use \fB--nodatamode\fP and/or NODATAEXIT settings to control what happens if no matching quotas are found.
.PP
PRO Users can use \fB--includedata\fP and \fB--excludedata\fP for this mode. Eg \fB--incl\fP _User=~bob \fB--incl\fP _StatusDescription=~exceeded
The quotas are defined as changed if the fields shown in the plugin output change between runs.
Check for changes by using \fB-w\fP _ItemChange=~true.
.TP
.B
Note:
This check can take a long time to collect the data. You may need to increase the timeout.
.RE
.TP
.B
checkservice
.RS
.TP
.B
ARG1
A regular expression that matches against the short or long service name that can be seen in the properties of the
service in Windows. The matching services are included in the resulting list. Use . alone to include all services.
Use Auto to check that all automatically started services are OK.
.TP
.B
ARG2
A regular expression that matches against the short or long service name that can be seen in the properties of the
service in Windows. The matching services are excluded in the resulting list.
This exclusion list is optional and applied after the inclusion list.
.TP
.B
ARG3
Optionally used to specify what type of services to display under which conditions. If not specified, all services are shown in all conditions. This is a comma delimited list of specifications in the following format: WHEN=WHAT, where WHEN is one of ok,warning,critical,unknown and WHAT is one of all,ok,bad,none. Examples: "ok=none,warning=bad,critical=bad" or "warning=all,critical=none". So to show only the "bad" services when a warning is given use "warning=bad".
.TP
.B
ARG4
Used to specify which type of services to display based on the StartMode. Only services with a StartMode matching this regular expression will be included. Examples: To include only manually started services use "\fB-4\fP manual". To include all automatic and manual services use "\fB-4\fP auto|man"
This list is optional and applied before the exclusion list.
.TP
.B
WARN/CRIT
can be used as described below.
Valid Warning/Critical Fields are: _NumBad (Default), _NumGood, _NumExcluded, _Total
.TP
.B
Note:
A "Good" service is one that is Started, its State is Running and its Status is OK. Anything else is considered "Bad". If you don't want certain services included in this count then you will need to exclude them with \fB-o\fP ARG2
.PP
PRO Users can use \fB--includedata\fP and \fB--excludedata\fP for this mode.
.RE
.PP
checkshare (PRO only)
.RS
.TP
.B
WARN/CRIT
can be used as described below.
Valid Warning/Critical Fields are: _ItemCount (Default), _ItemChange
.TP
.B
Note:
Use \fB--nodatamode\fP and/or NODATAEXIT settings to control what happens if no matching users are found.
.PP
PRO Users can use \fB--includedata\fP and \fB--excludedata\fP for this mode. Eg \fB--incl\fP Name=~C.
Check for changes by using \fB-w\fP _ItemChange=~true.
.RE
.TP
.B
checksmart
Check the SMART status of all hard drives on the system. Will only work for physical drives (ie not on disks in a virtual machine!). Probably will not work for disk array drives as they are not normally presented to the system as disks. Reports if any drives are failing the SMART checks which signals
imminent hard drive failure. It also grab various SMART attributes such as temperature. It also grab the disk serial
number which may work on OS versions above Win XP and Win Server 2003.
.RS
.TP
.B
ARG1
(optional) By default checksmart shows all of a small set of SMART attributes as peformance data. If you want to reduce this list you can by specifying a comma delimited list of attribute codes. Specify ARG1 as 'none' to obtain no SMART attributes. This will actually remove one of the WMI queries. Specify ARG1 as 'list' to list all the valid attribute codes. If you wish to warn/critical against the temperature value you must at least specify that code (194).
.TP
.B
WARN/CRIT
can be used as described below.
Valid Warning/Critical Fields are: _DiskFailing (Default), _ItemCount, Temperature
.TP
.B
Note:
This check does up to 4 WMI queries so it may be slow. You might need to use the \fB-t\fP option. Since 2 of the WMI queries are relatively static, their results are cached and you can set the refresh period for this data using \fB--joinexpiry\fP.
.TP
.B
Examples:
Warn if more than zero drives fail the SMART check or if any of the disk temperatures are above 40 degrees Celcius.
.RS
.PP
\fB-m\fP checksmart \fB-w\fP 0 \fB-w\fP Temperature=40
.PP
List only the SMART temperature
.PP
\fB-m\fP checksmart \fB-a\fP 194
.PP
List Temperature and Power on Hours
.PP
\fB-m\fP checksmart \fB-a\fP 194,9
.RE
.PP
PRO Users can use \fB--includedata\fP and \fB--excludedata\fP for this mode.
.RE
.PP
checkstartupcommand (PRO only)
.RS
.TP
.B
WARN/CRIT
can be used as described below.
Valid Warning/Critical Fields are: _ItemCount (Default), _ItemChange, Command, Description, Name, User
.TP
.B
Note:
Use \fB--nodatamode\fP and/or NODATAEXIT settings to control what happens if no matching commands are found.
.PP
PRO Users can use \fB--includedata\fP and \fB--excludedata\fP for this mode. Eg \fB--incl\fP _Name=~onedrive.
The startup commands are defined as changed if the fields shown in the plugin output change between runs.
Check for changes by using \fB-w\fP _ItemChange=~true.
.RE
.TP
.B
checktime
This mode compares the time on the Windows machine to the time on the server running Check WMI Plus. It uses UTC time. use the warning/critical criteria to trigger if the time difference exceeds a threshold that you define.
.RS
.TP
.B
WARN/CRIT
can be used as described below.
Valid Warning/Critical Fields are: _DiffSec (Default), _CWPSec, _WindowsSec
.RS
.PP
The warning/critical values should be specified in seconds and you will find a range most useful.
.PP
Typically you would specify something like \fB-w\fP \fB-10\fP:10 \fB-c\fP \fB-30\fP:30 (to warn if the time difference exceeds 10 seconds and go critical if the time difference exceeds 30 seconds)
.RE
.RE
.TP
.B
checkuptime
.RS
.TP
.B
WARN/CRIT
can be used as described below.
The only valid Warning/Critical Field is _UptimeSec, so you don't even need to specify it!
.RS
.PP
The warning/critical values should be specified in seconds. However you can use the time multipliers () to make it easier to use.
.PP
eg instead of putting \fB-w\fP 1800 you can use \fB-w\fP 30min
.PP
eg instead of putting \fB-w\fP 5400 you can use \fB-w\fP 1.5hr
.PP
Typically you would specify something like \fB-w\fP 20min: \fB-c\fP 10min: (to if less than 20 min and critical if less than 10 min)
.RE
.RE
.PP
checkuseraccount
.RS
.TP
.B
WARN/CRIT
can be used as described below.
Valid Warning/Critical Fields are: _ItemCount (Default), _ItemChange, Disabled, LocalAccount, Lockout, PasswordChangeable, PasswordExpires, PasswordRequired, SIDType, Status
.TP
.B
Note:
Use \fB--nodatamode\fP and/or NODATAEXIT settings to control what happens if no matching users are found.
.PP
PRO Users can use \fB--includedata\fP and \fB--excludedata\fP for this mode. Eg \fB--excl\fP Disabled=~true.
The user accounts are defined as changed if the fields shown in the plugin output change between runs.
Check for changes by using \fB-w\fP _ItemChange=~true.
.RE
.TP
.B
checkvolsize
This can be used to monitor volumes mounted as junction points (ie no drive letters) as well as normal logical volumes.
By default, drives in a non-OK state will be shown first.
Also see checkdrivesize
.RS
.TP
.B
ARG1
drive letter or volume name or volume label of the volume to check. If omitted a list of valid drives will be shown. If set to . all drives will be included.
To include multiple volumes separate them with a |. This uses a regular expression so take care to
specify exactly what you want. eg "C" or "C:" or "C|E" or "." or "Data"
.TP
.B
ARG2
Set this to 1 to use labels (if they are defined) in plugin output and performance data ie \fB-o\fP 1
.TP
.B
ARG3
Set this to 1 to include information about the sum of all volume space on the entire system.
If you set this you can also check warn/crit against the overall volume space.
To show only the overall volume, set ARG3 to 1 and set ARG1 to 1 (actually to any non-existant volume)
.TP
.B
ARG4
This is a 2 character string which controls how the drive information is displayed. 
.PP
.nf
.fam C
       Format is XY where
         X=0, display not-ok drives first
         X=1, display drives in the order the the WMI query returns them in
         X=2, only display not-ok drives
         X=3, If all drives are OK, same display as X=1. If there are any not OK drives, same display as X=2
         Y=0, show results on a single line
         Y=1, show results as multi-line with the first line being a high level summary of status 

.fam T
.fi
.TP
.B
WARN/CRIT
can be used as described below.
Valid Warning/Critical Fields are: _Used% (Default), _UsedSpace, _UsedGB, _Free%, FreeSpace_FreeGB.
.PP
PRO Users can use \fB--includedata\fP and \fB--excludedata\fP for this mode. Note that, if using ARG3, and these options, the system totals may be misleading.
.RE
.TP
.B
checkwsusserver
If there are any WSUS related errors in the event log in the last 24 hours a CRITICAL state is returned.
This mode has been removed. You can perform the same check that this used to perform by using MODE=checkeventlog 
using the wsusevents ini section. The command line parameters are:
\fB-m\fP checkeventlog \fB-o\fP 2 \fB-3\fP 24 \fB-4\fP wsusevents \fB-c\fP 0
.SH INI FILE HELP SUMMARY
The ini file and/or dir provides the following Modes and/or Submodes 
.TP
.B
checkad, failedreplicas (\fB-m\fP checkad \fB-s\fP failedreplicas)
Check the for failed replication of an Active Directory. Tested with AD v2xxx. Shows the number of failed replicas.
.RS
.TP
.B
Note:
Use \fB--nodatamode\fP and/or NODATAEXIT settings to control what happens if no failed replicas are found. 
Typically run with \fB-c\fP 0, to go critical when any sync failures are found.
.TP
.B
WARN/CRIT
can be used for this MODE. You need to specify a field name if not using the Default field eg \fB-w\fP FIELD=VALUE or simply \fB-w\fP VALUE for the Default field. Valid Warning/Critical Fields are: _TotalFailures (Default), NumConsecutiveSyncFailures, _ItemCount
.RE
.TP
.B
checkad, replication (\fB-m\fP checkad \fB-s\fP replication)
Check the full replication of an Active Directory. Tested with AD v2003. Shows the number of failed replicas.
.RS
.TP
.B
Note:
Use \fB--nodatamode\fP and/or NODATAEXIT settings to control what happens if no failed replicas are found. 
Developed and tested by Patrick Fratczak. Typically run with \fB-c\fP 0, to go critical when any failed replicas are found.
.TP
.B
WARN/CRIT
can be used for this MODE. You need to specify a field name if not using the Default field eg \fB-w\fP FIELD=VALUE or simply \fB-w\fP VALUE for the Default field. Valid Warning/Critical Fields are: _ItemCount (Default)
.RE
.TP
.B
checkcpuperf, percusertime (\fB-m\fP checkcpuperf \fB-s\fP percusertime)
No help available
.RS
.TP
.B
DELAY
(optional) specifies the number of seconds over which the utilisation is calculated. The longer you can make this without timing out, the more accurate it will be. If specifying longer values. You may also need to use the \fB-t\fP parameter to set a longer script timeout. Only valid if also specifying \fB--nokeepstate\fP ie you are not using the state keeping feature. We recommend that you do keep state and hence do not use \fB--nokeepstate\fP. Default is 5.
.TP
.B
WARN/CRIT
can be used for this MODE. You need to specify a field name if not using the Default field eg \fB-w\fP FIELD=VALUE or simply \fB-w\fP VALUE for the Default field. Valid Warning/Critical Fields are: _ContextSwitchesPerSec (Default)
.RE
.TP
.B
checkdhcp, stats (\fB-m\fP checkdhcp \fB-s\fP stats)
Checks various stats for Microsoft Windows Server running as an IPv4 DHCP Server
Tested for Windows Server 2003/2008 R2. Only tested on a low volume server.
.RS
.TP
.B
Note:
You may want to use \fB--nodatamode\fP so that you can control how the plugin responds when no data is returned by the WMI query.
.TP
.B
DELAY
(optional) specifies the number of seconds over which the utilisation is calculated. The longer you can make this without timing out, the more accurate it will be. If specifying longer values. You may also need to use the \fB-t\fP parameter to set a longer script timeout. Only valid if also specifying \fB--nokeepstate\fP ie you are not using the state keeping feature. We recommend that you do keep state and hence do not use \fB--nokeepstate\fP. Default is 5.
.TP
.B
WARN/CRIT
can be used for this MODE. You need to specify a field name if not using the Default field eg \fB-w\fP FIELD=VALUE or simply \fB-w\fP VALUE for the Default field. Valid Warning/Critical Fields are: _AcksPersec (Default), ActiveQueueLength, ConflictCheckQueueLength, Deniedduetomatch, Deniedduetononmatch, _DeclinesPersec, _DiscoversPersec, _OffersPersec, _PacketsReceivedPersec, _ReleasesPersec, _RequestsPersec
.RE
.TP
.B
checkdhcpv6, stats (\fB-m\fP checkdhcpv6 \fB-s\fP stats)
Checks various stats for Microsoft Windows Server running as an IPv6 DHCP Server
Tested for Windows Server 2008 R2. Only tested on a zero volume server!!
.RS
.TP
.B
DELAY
(optional) specifies the number of seconds over which the utilisation is calculated. The longer you can make this without timing out, the more accurate it will be. If specifying longer values. You may also need to use the \fB-t\fP parameter to set a longer script timeout. Only valid if also specifying \fB--nokeepstate\fP ie you are not using the state keeping feature. We recommend that you do keep state and hence do not use \fB--nokeepstate\fP. Default is 5.
.TP
.B
WARN/CRIT
can be used for this MODE. You need to specify a field name if not using the Default field eg \fB-w\fP FIELD=VALUE or simply \fB-w\fP VALUE for the Default field. Valid Warning/Critical Fields are: _AcksPersec (Default), ActiveQueueLength, _ConfirmsPersec, _DeclinesPersec, _PacketsReceivedPersec, _ReleasesPersec, _RequestsPersec
.RE
.TP
.B
checkdns, arecords (\fB-m\fP checkdns \fB-s\fP arecords)
Shows the number of DNS A records defined.
Tested for Windows Server 2003/2008 R2. Only tested on a low volume server.
.RS
.TP
.B
ARG1
(optional) Specify a ContainerName (normally seen as a domain name) to restrict the search to
.TP
.B
Note:
You may want to use \fB--nodatamode\fP so that you can control how the plugin responds when no data is returned by the WMI query.
.TP
.B
WARN/CRIT
can be used for this MODE. You need to specify a field name if not using the Default field eg \fB-w\fP FIELD=VALUE or simply \fB-w\fP VALUE for the Default field. Valid Warning/Critical Fields are: _ItemCount (Default)
.RE
.TP
.B
checkdns, cnamerecords (\fB-m\fP checkdns \fB-s\fP cnamerecords)
Shows the number of DNS CNAME records defined.
Tested for Windows Server 2003/2008 R2. Only tested on a low volume server.
.RS
.TP
.B
ARG1
(optional) Specify a ContainerName (normally seen as a domain name) to restrict the search to
.TP
.B
Note:
You may want to use \fB--nodatamode\fP so that you can control how the plugin responds when no data is returned by the WMI query.
.TP
.B
WARN/CRIT
can be used for this MODE. You need to specify a field name if not using the Default field eg \fB-w\fP FIELD=VALUE or simply \fB-w\fP VALUE for the Default field. Valid Warning/Critical Fields are: _ItemCount (Default)
.RE
.TP
.B
checkdns, ptrrecords (\fB-m\fP checkdns \fB-s\fP ptrrecords)
Shows the number of DNS PTR records defined.
Tested for Windows Server 2003/2008 R2. Only tested on a low volume server.
.RS
.TP
.B
ARG1
(optional) Specify a ContainerName (normally seen as a domain name) to restrict the search to
.TP
.B
Note:
You may want to use \fB--nodatamode\fP so that you can control how the plugin responds when no data is returned by the WMI query.
.TP
.B
WARN/CRIT
can be used for this MODE. You need to specify a field name if not using the Default field eg \fB-w\fP FIELD=VALUE or simply \fB-w\fP VALUE for the Default field. Valid Warning/Critical Fields are: _ItemCount (Default)
.RE
.TP
.B
checkdns, stats (\fB-m\fP checkdns \fB-s\fP stats)
Checks various stats for Microsoft Windows Server running as a DNS Server.
Tested for Windows Server 2003/2008 R2. Only tested on a low volume server.
.RS
.TP
.B
DELAY
(optional) specifies the number of seconds over which the utilisation is calculated. The longer you can make this without timing out, the more accurate it will be. If specifying longer values. You may also need to use the \fB-t\fP parameter to set a longer script timeout. Only valid if also specifying \fB--nokeepstate\fP ie you are not using the state keeping feature. We recommend that you do keep state and hence do not use \fB--nokeepstate\fP. Default is 5.
.TP
.B
WARN/CRIT
can be used for this MODE. You need to specify a field name if not using the Default field eg \fB-w\fP FIELD=VALUE or simply \fB-w\fP VALUE for the Default field. Valid Warning/Critical Fields are: CachingMemory (Default), DatabaseNodeMemory, DynamicUpdateReceived, _DynamicUpdateReceivedPersec, RecursiveQueries, _RecursiveQueriesPersec, RecursiveQueryFailure, _RecursiveTimeOutPersec, TotalQueryReceived, _TotalQueryReceivedPersec, TCPQueryReceived, _TCPQueryReceivedPersec, UDPQueryReceived, _UDPQueryReceivedPersec, WINSLookupReceived, _WINSLookupReceivedPersec
.RE
.TP
.B
checkdtc (\fB-m\fP checkdtc)
Check some counters for the Microsoft Distributed Transaction Coordinator.
.RE
.PP

.RS
.TP
.B
WARN/CRIT
can be used for this MODE. You need to specify a field name if not using the Default field eg \fB-w\fP FIELD=VALUE or simply \fB-w\fP VALUE for the Default field. Valid Warning/Critical Fields are: AbortedTransactions (Default), AbortedTransactionsPersec, ActiveTransactions, ActiveTransactionsMaximum, CommittedTransactions, CommittedTransactionsPersec, InDoubtTransactions, ResponseTimeAverage, ResponseTimeMaximum, ResponseTimeMinimum, TransactionsPersec
.RE
.TP
.B
checkeachcpu (\fB-m\fP checkeachcpu)
Get CPU performance (like checkcpu) but provide information for each CPU. Cores are seen as CPUs. 
.RS
.TP
.B
DELAY
(optional) specifies the number of seconds over which the utilisation is calculated. The longer you can make this without timing out, the more accurate it will be. If specifying longer values. You may also need to use the \fB-t\fP parameter to set a longer script timeout. Only valid if also specifying \fB--nokeepstate\fP ie you are not using the state keeping feature. We recommend that you do keep state and hence do not use \fB--nokeepstate\fP. Default is 5.
.TP
.B
WARN/CRIT
can be used for this MODE. You need to specify a field name if not using the Default field eg \fB-w\fP FIELD=VALUE or simply \fB-w\fP VALUE for the Default field. Valid Warning/Critical Fields are: _AvgCPU (Default)
.RE
.TP
.B
checkexchange, DBInstances (\fB-m\fP checkexchange \fB-s\fP DBInstances)
Check Microsoft Exchange DB Instances. Tested for Microsoft Exchange 2010. Might work on earlier versions.
Only works for instances currently mounted. Can be used to detect instances that become unmounted.
There is very limited documentation on this WMI Class. We have made our best guess at calculating the values correctly.
The latency calculations might still be wrong. See the ini file for comments.
.RS
.TP
.B
ARG1
The Instance name to view stats for. Use % for wildcards. Use only a single % to include stats for all Instances.
Use the helper check checkexchange listDBInstance to list valid instances names.
.TP
.B
DELAY
(optional) specifies the number of seconds over which the utilisation is calculated. The longer you can make this without timing out, the more accurate it will be. If specifying longer values. You may also need to use the \fB-t\fP parameter to set a longer script timeout. Only valid if also specifying \fB--nokeepstate\fP ie you are not using the state keeping feature. We recommend that you do keep state and hence do not use \fB--nokeepstate\fP. Default is 5.
.TP
.B
WARN/CRIT
can be used for this MODE. You need to specify a field name if not using the Default field eg \fB-w\fP FIELD=VALUE or simply \fB-w\fP VALUE for the Default field. Valid Warning/Critical Fields are: _ItemCount (Default), _DatabaseCachePercentHit, DatabaseCacheSizeMB, _DatabaseCacheRequestsPersec, _DatabaseCacheMissesPersec, _IODatabaseReadsAverageLatency, _IODatabaseWritesAverageLatency, _IOLogReadsAverageLatency, _IOLogWritesAverageLatency, _IODatabaseReadsPersec, _IODatabaseWritesPersec, _IOLogReadsPersec, _IOLogWritesPersec, _LogBytesWritePersec, SessionsInUse, _TableOpenCachePercentHit, TablesOpen, _TableOpensPersec
.RE
.TP
.B
checkexchange, HubTransportServer (\fB-m\fP checkexchange \fB-s\fP HubTransportServer)
Check Exchange Monitoring Hub Transport Server.
.RS
.TP
.B
DELAY
(optional) specifies the number of seconds over which the utilisation is calculated. The longer you can make this without timing out, the more accurate it will be. If specifying longer values. You may also need to use the \fB-t\fP parameter to set a longer script timeout. Only valid if also specifying \fB--nokeepstate\fP ie you are not using the state keeping feature. We recommend that you do keep state and hence do not use \fB--nokeepstate\fP. Default is 5.
.TP
.B
WARN/CRIT
can be used for this MODE. You need to specify a field name if not using the Default field eg \fB-w\fP FIELD=VALUE or simply \fB-w\fP VALUE for the Default field. Valid Warning/Critical Fields are: _ItemsCompletedDeliveryPerSecond (Default), _ItemsQueuedforDeliveryPerSecond, _MessagesCompletedDeliveryPerSecond, _MessagesQueuedforDeliveryPerSecond, _MessagesSubmittedPerSecond, ItemsCompletedDeliveryTotal, MessagesSubmittedTotal, ActiveMailboxDeliveryQueueLength, ActiveNonSmtpDeliveryQueueLength, ActiveRemoteDeliveryQueueLength, AggregateDeliveryQueueLengthAllQueues, SubmissionQueueLength, RetryMailboxDeliveryQueueLength, RetryNonSmtpDeliveryQueueLength, RetryRemoteDeliveryQueueLength, UnreachableQueueLength, LargestDeliveryQueueLength, PoisonQueueLength
.RE
.TP
.B
checkexchange, SmtpReceive (\fB-m\fP checkexchange \fB-s\fP SmtpReceive)
Check Microsoft Exchange Transport SMTP Receive. Tested for Microsoft Exchange 2007.
.RS
.TP
.B
ARG1
The transport/queue name to view stats for. Use _Total for the total stats for all transports.
Use % for wildcards. Use only a single % to include stats for all transports.
Use the helper check checkexchange listSmtpReceiveTransports to list valid transport names.
.TP
.B
DELAY
(optional) specifies the number of seconds over which the utilisation is calculated. The longer you can make this without timing out, the more accurate it will be. If specifying longer values. You may also need to use the \fB-t\fP parameter to set a longer script timeout. Only valid if also specifying \fB--nokeepstate\fP ie you are not using the state keeping feature. We recommend that you do keep state and hence do not use \fB--nokeepstate\fP. Default is 5.
.TP
.B
WARN/CRIT
can be used for this MODE. You need to specify a field name if not using the Default field eg \fB-w\fP FIELD=VALUE or simply \fB-w\fP VALUE for the Default field. Valid Warning/Critical Fields are: _BytesReceivedPersec (Default), _ConnectionsCreatedPersec, _DisconnectionsbyAgentsPersecond, _MessageBytesReceivedPersec, _MessagesReceivedPersec, AveragebytesPerconnection_Base, AveragebytesPermessage, AveragebytesPermessage_Base, AveragemessagesPerconnection, AveragemessagesPerconnection_Base, AveragerecipientsPermessage, AveragerecipientsPermessage_Base, BytesReceivedTotal, ConnectionsTotal, Frequency_PerfTime, MessageBytesReceivedTotal, MessagesReceivedTotal, RecipientsacceptedTotal, TarpittingDelaysAnonymous
.RE
.TP
.B
checkexchange, SmtpSend (\fB-m\fP checkexchange \fB-s\fP SmtpSend)
Check Microsoft Exchange Transport SMTP Send. Tested for Microsoft Exchange 2007.
.RS
.TP
.B
ARG1
The transport/queue name to view stats for. Use _Total for the total stats for all transports.
Use % for wildcards. Use only a single "%" to include stats for all transports.
Use the helper check "checkexchange listSmtpSendTransports" to list valid transport names.
.TP
.B
DELAY
(optional) specifies the number of seconds over which the utilisation is calculated. The longer you can make this without timing out, the more accurate it will be. If specifying longer values. You may also need to use the \fB-t\fP parameter to set a longer script timeout. Only valid if also specifying \fB--nokeepstate\fP ie you are not using the state keeping feature. We recommend that you do keep state and hence do not use \fB--nokeepstate\fP. Default is 5.
.TP
.B
WARN/CRIT
can be used for this MODE. You need to specify a field name if not using the Default field eg \fB-w\fP FIELD=VALUE or simply \fB-w\fP VALUE for the Default field. Valid Warning/Critical Fields are: _BytesSentPersec (Default), _ConnectionsCreatedPersec, _MessageBytesSentPersec, _MessagesSentPersec, AveragebytesPerconnection, AveragebytesPerconnection_Base, AveragemessagebytesPermessage, AveragemessagebytesPermessage_Base, AveragemessagesPerconnection, AveragemessagesPerconnection_Base, AveragerecipientsPermessage, AveragerecipientsPermessage_Base, BytesSentTotal, ConnectionsTotal, Frequency_PerfTime, MessageBytesSentTotal, MessagesSentTotal, Recipientssent
.RE
.TP
.B
checkexchange, TransportQueues (\fB-m\fP checkexchange \fB-s\fP TransportQueues)
Check Microsoft Exchange Transport Queues. Tested for Microsoft Exchange 2007.
.RS
.TP
.B
DELAY
(optional) specifies the number of seconds over which the utilisation is calculated. The longer you can make this without timing out, the more accurate it will be. If specifying longer values. You may also need to use the \fB-t\fP parameter to set a longer script timeout. Only valid if also specifying \fB--nokeepstate\fP ie you are not using the state keeping feature. We recommend that you do keep state and hence do not use \fB--nokeepstate\fP. Default is 5.
.TP
.B
WARN/CRIT
can be used for this MODE. You need to specify a field name if not using the Default field eg \fB-w\fP FIELD=VALUE or simply \fB-w\fP VALUE for the Default field. Valid Warning/Critical Fields are: _ItemsCompletedDeliveryPerSecond (Default), _ItemsQueuedforDeliveryPerSecond, _MessagesCompletedDeliveryPerSecond, _MessagesQueuedforDeliveryPerSecond, _MessagesSubmittedPerSecond, ActiveMailboxDeliveryQueueLength, ActiveNonSmtpDeliveryQueueLength, ActiveRemoteDeliveryQueueLength, AggregateDeliveryQueueLengthAllQueues, ItemsCompletedDeliveryTotal, ItemsQueuedForDeliveryTotal, ItemsResubmittedTotal, LargestDeliveryQueueLength, MessagesCompletedDeliveryTotal, MessagesQueuedForDelivery, MessagesQueuedForDeliveryTotal, MessagesSubmittedTotal, PoisonQueueLength, RetryMailboxDeliveryQueueLength, RetryNonSmtpDeliveryQueueLength, RetryRemoteDeliveryQueueLength, SubmissionQueueItemsExpiredTotal
.RE
.TP
.B
checkexchange, listDBInstances (\fB-m\fP checkexchange \fB-s\fP listDBInstances)
List the currently mounted Exchange Database instances. This is a helper check for checkexchange DBInstances but does contain some performance data. Only shows instances currently mounted. Can be used to detect instances that become unmounted.
Tested for Microsoft Exchange 2010.
.RS
.TP
.B
WARN/CRIT
can be used for this MODE. You need to specify a field name if not using the Default field eg \fB-w\fP FIELD=VALUE or simply \fB-w\fP VALUE for the Default field. Valid Warning/Critical Fields are: _ItemCount (Default), SessionsInUse
.RE
.TP
.B
checkexchange, listSmtpReceiveTransports (\fB-m\fP checkexchange \fB-s\fP listSmtpReceiveTransports)
List the transports available for SMPT Receive. This is a helper check for checkexchange SmtpReceive.
.RS
.TP
.B
WARN/CRIT
Not used for this MODE.
.RE
.TP
.B
checkexchange, listSmtpSendTransports (\fB-m\fP checkexchange \fB-s\fP listSmtpSendTransports)
List the transports available for SMPT Send. This is a helper check for checkexchange SmtpSend.
.RS
.TP
.B
WARN/CRIT
Not used for this MODE.
.RE
.TP
.B
checkexchange2003, listDBInstances (\fB-m\fP checkexchange2003 \fB-s\fP listDBInstances)
List the currently mounted Exchange Database instances. This is a helper check for checkexchange DBInstances but does contain some performance data. Only shows instances currently mounted. Can be used to detect instances that become unmounted.
Tested for Microsoft Exchange 2003.
.RS
.TP
.B
WARN/CRIT
can be used for this MODE. You need to specify a field name if not using the Default field eg \fB-w\fP FIELD=VALUE or simply \fB-w\fP VALUE for the Default field. Valid Warning/Critical Fields are: _ItemCount (Default), SessionsInUse
.RE
.TP
.B
checkfolderfileage (\fB-m\fP checkfolderfileage)
Check a Folder for files of a certain age.
You most likely want to use \fB--includedata\fP and or \fB--excludedata\fP to list only the files that match the age you are interested in and then use \fB-w\fP and \fB-c\fP to warn against the number of files you end up finding.
For example, find files in c:/temp with an age of between 0 and 10000 seconds. 
Warn if you find more than 3 of these. 
Use the parameters \fB-a\fP c: \fB-o\fP /temp/ \fB-inc\fP _FileAge=@0:10000 \fB-w\fP 3. 
Alternatively, you could just warn against the _FileAge directly eg \fB-a\fP c: \fB-o\fP /temp/ \fB-w\fP _FileAge=1000
.RS
.TP
.B
ARG1
The drive letter of the folder  eg C:
.TP
.B
ARG2
The path of the folder on the specified drive eg /temp/. Folders must end in /
.TP
.B
WARN/CRIT
can be used for this MODE. You need to specify a field name if not using the Default field eg \fB-w\fP FIELD=VALUE or simply \fB-w\fP VALUE for the Default field. Valid Warning/Critical Fields are: _ItemCount (Default), _FileAge
.RE
.TP
.B
checkiis, anonusers (\fB-m\fP checkiis \fB-s\fP anonusers)
No help available
.RS
.TP
.B
DELAY
(optional) specifies the number of seconds over which the utilisation is calculated. The longer you can make this without timing out, the more accurate it will be. If specifying longer values. You may also need to use the \fB-t\fP parameter to set a longer script timeout. Only valid if also specifying \fB--nokeepstate\fP ie you are not using the state keeping feature. We recommend that you do keep state and hence do not use \fB--nokeepstate\fP. Default is 5.
.TP
.B
WARN/CRIT
can be used for this MODE. You need to specify a field name if not using the Default field eg \fB-w\fP FIELD=VALUE or simply \fB-w\fP VALUE for the Default field. Valid Warning/Critical Fields are: _AnonymousUsersPersec (Default), CurrentAnonymousUsers
.RE
.TP
.B
checkiis, connections (\fB-m\fP checkiis \fB-s\fP connections)
Check connection stats for a Microsoft IIS Web Server.
Tested for IIS version 6.0 and 7.5. Only tested on a low volume server.
.RS
.TP
.B
ARG1
The web server instance name to view stats for. Use _Total for the total stats for all web sites.
The web server instance name can be seen in the Microsoft IIS Manager.
eg "Default Web Site"
.TP
.B
DELAY
(optional) specifies the number of seconds over which the utilisation is calculated. The longer you can make this without timing out, the more accurate it will be. If specifying longer values. You may also need to use the \fB-t\fP parameter to set a longer script timeout. Only valid if also specifying \fB--nokeepstate\fP ie you are not using the state keeping feature. We recommend that you do keep state and hence do not use \fB--nokeepstate\fP. Default is 5.
.TP
.B
WARN/CRIT
can be used for this MODE. You need to specify a field name if not using the Default field eg \fB-w\fP FIELD=VALUE or simply \fB-w\fP VALUE for the Default field. Valid Warning/Critical Fields are: CurrentConnections (Default), _ConnectionAttemptsPersec
.RE
.TP
.B
checkiis, errors (\fB-m\fP checkiis \fB-s\fP errors)
Check error stats for a Microsoft IIS Web Server.
Tested for IIS version 6.0 and 7.5. Only tested on a low volume server.
.RS
.TP
.B
ARG1
The web server instance name to view stats for. Use _Total for the total stats for all web sites.
The web server instance name can be seen in the Microsoft IIS Manager.
eg "Default Web Site"
.TP
.B
DELAY
(optional) specifies the number of seconds over which the utilisation is calculated. The longer you can make this without timing out, the more accurate it will be. If specifying longer values. You may also need to use the \fB-t\fP parameter to set a longer script timeout. Only valid if also specifying \fB--nokeepstate\fP ie you are not using the state keeping feature. We recommend that you do keep state and hence do not use \fB--nokeepstate\fP. Default is 5.
.TP
.B
WARN/CRIT
can be used for this MODE. You need to specify a field name if not using the Default field eg \fB-w\fP FIELD=VALUE or simply \fB-w\fP VALUE for the Default field. Valid Warning/Critical Fields are: _NotFoundErrorsPersec (Default), _LockedErrorsPersec, TotalNotFoundErrors, TotalLockedErrors
.RE
.TP
.B
checkiis, requests (\fB-m\fP checkiis \fB-s\fP requests)
Check request stats for a Microsoft IIS Web Server.
Tested for IIS version 6.0 and 7.5. Only tested on a low volume server.
.RS
.TP
.B
ARG1
The web server instance name to view stats for. Use _Total for the total stats for all web sites.
The web server instance name can be seen in the Microsoft IIS Manager.
eg "Default Web Site"
.TP
.B
DELAY
(optional) specifies the number of seconds over which the utilisation is calculated. The longer you can make this without timing out, the more accurate it will be. If specifying longer values. You may also need to use the \fB-t\fP parameter to set a longer script timeout. Only valid if also specifying \fB--nokeepstate\fP ie you are not using the state keeping feature. We recommend that you do keep state and hence do not use \fB--nokeepstate\fP. Default is 5.
.TP
.B
WARN/CRIT
can be used for this MODE. You need to specify a field name if not using the Default field eg \fB-w\fP FIELD=VALUE or simply \fB-w\fP VALUE for the Default field. Valid Warning/Critical Fields are: _GetRequestsPersec (Default), _HeadRequestsPersec, _PostRequestsPersec, _PropfindRequestsPersec, _PutRequestsPersec, _ISAPIExtensionRequestsPersec, TotalGetRequests, TotalHeadRequests, TotalPostRequests, TotalPropfindRequests, TotalPutRequests, TotalISAPIExtensionRequests
.RE
.TP
.B
checkiis, transfers (\fB-m\fP checkiis \fB-s\fP transfers)
Check transfer stats (bytes and files) for a Microsoft IIS Web Server.
Tested for IIS version 6.0 and 7.5. Only tested on a low volume server.
.RS
.TP
.B
ARG1
The web server instance name to view stats for. Use _Total for the total stats for all web sites.
The web server instance name can be seen in the Microsoft IIS Manager.
eg "Default Web Site"
.TP
.B
DELAY
(optional) specifies the number of seconds over which the utilisation is calculated. The longer you can make this without timing out, the more accurate it will be. If specifying longer values. You may also need to use the \fB-t\fP parameter to set a longer script timeout. Only valid if also specifying \fB--nokeepstate\fP ie you are not using the state keeping feature. We recommend that you do keep state and hence do not use \fB--nokeepstate\fP. Default is 5.
.TP
.B
WARN/CRIT
can be used for this MODE. You need to specify a field name if not using the Default field eg \fB-w\fP FIELD=VALUE or simply \fB-w\fP VALUE for the Default field. Valid Warning/Critical Fields are: _BytesTotalPersec (Default), _BytesReceivedPersec, _BytesSentPersec, _FilesPersec, _FilesReceivedPersec, _FilesSentPersec, TotalBytesTransferred, TotalBytesReceived, TotalBytesSent, TotalFilesTransferred, TotalFilesReceived, TotalFilesSent
.RE
.TP
.B
checkiis, transfersV5 (\fB-m\fP checkiis \fB-s\fP transfersV5)
Check transfer stats (bytes and files) for a Microsoft IIS Web Server.
Tested for IIS version 5.1 (Windows XP). Only tested on a low volume server.
.RS
.TP
.B
ARG1
The web server instance name to view stats for. Use _Total for the total stats for all web sites.
The web server instance name can be seen in the Microsoft IIS Manager.
eg "Default Web Site"
.TP
.B
DELAY
(optional) specifies the number of seconds over which the utilisation is calculated. The longer you can make this without timing out, the more accurate it will be. If specifying longer values. You may also need to use the \fB-t\fP parameter to set a longer script timeout. Only valid if also specifying \fB--nokeepstate\fP ie you are not using the state keeping feature. We recommend that you do keep state and hence do not use \fB--nokeepstate\fP. Default is 5.
.TP
.B
WARN/CRIT
can be used for this MODE. You need to specify a field name if not using the Default field eg \fB-w\fP FIELD=VALUE or simply \fB-w\fP VALUE for the Default field. Valid Warning/Critical Fields are: _BytesTotalPersec (Default), _BytesReceivedPersec, _BytesSentPersec, _FilesPersec, _FilesReceivedPersec, _FilesSentPersec, TotalFilesTransferred, TotalFilesReceived, TotalFilesSent
.RE
.TP
.B
checkiis, users (\fB-m\fP checkiis \fB-s\fP users)
Check user stats for a Microsoft IIS Web Server.
Tested for IIS version 6.0 and 7.5. Only tested on a low volume server.
.RS
.TP
.B
ARG1
The web server instance name to view stats for. Use _Total for the total stats for all web sites.
The web server instance name can be seen in the Microsoft IIS Manager.
eg "Default Web Site"
.TP
.B
DELAY
(optional) specifies the number of seconds over which the utilisation is calculated. The longer you can make this without timing out, the more accurate it will be. If specifying longer values. You may also need to use the \fB-t\fP parameter to set a longer script timeout. Only valid if also specifying \fB--nokeepstate\fP ie you are not using the state keeping feature. We recommend that you do keep state and hence do not use \fB--nokeepstate\fP. Default is 5.
.TP
.B
WARN/CRIT
can be used for this MODE. You need to specify a field name if not using the Default field eg \fB-w\fP FIELD=VALUE or simply \fB-w\fP VALUE for the Default field. Valid Warning/Critical Fields are: _LogonAttemptsPersec (Default), CurrentAnonymousUsers, CurrentNonAnonymousUsers, _AnonymousUsersPersec, _NonAnonymousUsersPersec, TotalLogonAttempts, TotalAnonymousUsers, TotalNonAnonymousUsers
.RE
.TP
.B
checkio, logical (\fB-m\fP checkio \fB-s\fP logical)
Check logical disk IO. 
These disks checks use WMI Raw counters to calculate values over a given timeperiod. 
This is much more accurate than taking Formatted WMI values.
Note that some of the PercentDisk values seem to give incorrect values. Use with caution.
This check can return data for multiple drives in a single check.
.RS
.TP
.B
ARG1
Name of the logical Windows drive to check eg C:. Use % for Wilcard.
Use _Total to check all drives combined.
.RE
.PP

.RS
.TP
.B
DELAY
(optional) specifies the number of seconds over which the utilisation is calculated. The longer you can make this without timing out, the more accurate it will be. If specifying longer values. You may also need to use the \fB-t\fP parameter to set a longer script timeout. Only valid if also specifying \fB--nokeepstate\fP ie you are not using the state keeping feature. We recommend that you do keep state and hence do not use \fB--nokeepstate\fP. Default is 5.
.TP
.B
WARN/CRIT
can be used for this MODE. You need to specify a field name if not using the Default field eg \fB-w\fP FIELD=VALUE or simply \fB-w\fP VALUE for the Default field. Valid Warning/Critical Fields are: _PercentIdleTime (Default), _PercentBusyTime, _PercentDiskTime, _PercentDiskReadTime, _PercentDiskWriteTime, _DiskReadBytesPersec, _DiskReadsPersec, _DiskWriteBytesPersec, _DiskWritesPersec, CurrentDiskQueueLength, _AvgDiskQueueLength, _AvgDiskReadQueueLength, _AvgDiskWriteQueueLength
.RE
.TP
.B
checkio, old_logical (\fB-m\fP checkio \fB-s\fP old_logical)
Check logical disk IO. Superseeded by checkio logical.
.RS
.TP
.B
ARG1
Name of the logical Windows drive to check eg C:. Use _Total to check all drives combined.
.TP
.B
WARN/CRIT
can be used for this MODE. You need to specify a field name if not using the Default field eg \fB-w\fP FIELD=VALUE or simply \fB-w\fP VALUE for the Default field. Valid Warning/Critical Fields are: PercentDiskTime (Default), PercentIdleTime, PercentDiskReadTime, PercentDiskWriteTime, DiskReadBytesPersec, DiskReadsPersec, DiskWriteBytesPersec, DiskWritesPersec, CurrentDiskQueueLength, AvgDiskQueueLength, AvgDiskReadQueueLength, AvgDiskWriteQueueLength
.RE
.TP
.B
checkio, old_physical (\fB-m\fP checkio \fB-s\fP old_physical)
Check physical disk IO. Superseeded by checkio physical.
.RS
.TP
.B
ARG1
Name of the physical Windows drive to check eg C:. Use _Total to check all drives combined.
.TP
.B
WARN/CRIT
can be used for this MODE. You need to specify a field name if not using the Default field eg \fB-w\fP FIELD=VALUE or simply \fB-w\fP VALUE for the Default field. Valid Warning/Critical Fields are: PercentDiskTime (Default), PercentIdleTime, PercentDiskReadTime, PercentDiskWriteTime, DiskReadBytesPersec, DiskReadsPersec, DiskWriteBytesPersec, DiskWritesPersec, CurrentDiskQueueLength, AvgDiskQueueLength, AvgDiskReadQueueLength, AvgDiskWriteQueueLength
.RE
.TP
.B
checkio, physical (\fB-m\fP checkio \fB-s\fP physical)
Check physical disk IO. 
These disks checks use WMI Raw counters to calculate values over a given timeperiod. 
This is much more accurate than taking Formatted WMI values.
Note that some of the PercentDisk values seem to give incorrect values. Use with caution.
This check can return data for multiple drives in a single check.
.RS
.TP
.B
ARG1
Name of the logical Windows drive to check eg C: Use % for Wilcard.
Use _Total to check all drives combined.
.TP
.B
DELAY
(optional) specifies the number of seconds over which the utilisation is calculated. The longer you can make this without timing out, the more accurate it will be. If specifying longer values. You may also need to use the \fB-t\fP parameter to set a longer script timeout. Only valid if also specifying \fB--nokeepstate\fP ie you are not using the state keeping feature. We recommend that you do keep state and hence do not use \fB--nokeepstate\fP. Default is 5.
.TP
.B
WARN/CRIT
can be used for this MODE. You need to specify a field name if not using the Default field eg \fB-w\fP FIELD=VALUE or simply \fB-w\fP VALUE for the Default field. Valid Warning/Critical Fields are: _PercentIdleTime (Default), _PercentBusyTime, _PercentDiskTime, _PercentDiskReadTime, _PercentDiskWriteTime, _DiskReadBytesPersec, _DiskReadsPersec, _DiskWriteBytesPersec, _DiskWritesPersec, CurrentDiskQueueLength, _AvgDiskQueueLength, _AvgDiskReadQueueLength, _AvgDiskWriteQueueLength
.RE
.TP
.B
checkpower, state (\fB-m\fP checkpower \fB-s\fP state)
This check shows the state of one or more power supplies. Only appears to work on Server 2008. Not tested on physical hardware. It would be really helpful of someone using this on physical hardware can send me the output of this check adding the \fB-d\fP option to the command line.
.RS
.TP
.B
ARG1
The power supply number to view stats for. Power supplies start at 0. 
Use % for wildcards. Use only a single % to include stats for all power supplies.
.TP
.B
WARN/CRIT
can be used for this MODE. You need to specify a field name if not using the Default field eg \fB-w\fP FIELD=VALUE or simply \fB-w\fP VALUE for the Default field. Valid Warning/Critical Fields are: ActiveInputVoltage (Default), TotalOutputPower, TotalPowerOnHours
.RE
.TP
.B
checkprint, spooler (\fB-m\fP checkprint \fB-s\fP spooler)
Checks various print spooler stats
Tested for Windows Server 2003/2008 R2. Only tested on a low volume server.
This check can return information about multiple printers in a single check.
.RS
.TP
.B
ARG1
The printer queue name to view stats for. Use _Total for the total stats for all print queues.
Use % for wildcards. The printer queue name can be seen in the Device and Printer screen
eg "Microsoft XPS Document Writer", "%laser%".
.TP
.B
DELAY
(optional) specifies the number of seconds over which the utilisation is calculated. The longer you can make this without timing out, the more accurate it will be. If specifying longer values. You may also need to use the \fB-t\fP parameter to set a longer script timeout. Only valid if also specifying \fB--nokeepstate\fP ie you are not using the state keeping feature. We recommend that you do keep state and hence do not use \fB--nokeepstate\fP. Default is 5.
.TP
.B
WARN/CRIT
can be used for this MODE. You need to specify a field name if not using the Default field eg \fB-w\fP FIELD=VALUE or simply \fB-w\fP VALUE for the Default field. Valid Warning/Critical Fields are: _BytesPrintedPersec (Default), JobErrors, Jobs, JobsSpooling, NotReadyErrors, OutofPaperErrors, TotalJobsPrinted, TotalPagesPrinted
.RE
.TP
.B
checkprint, test (\fB-m\fP checkprint \fB-s\fP test)
Demo check for join= and joinquery= settings.
Grabs the same information as checkprinter spooler but adds a couple of extra fields from another WMI Class. 
.RS
.TP
.B
ARG1
The printer queue name to view stats for. Use _Total for the total stats for all print queues.
Use % for wildcards. The printer queue name can be seen in the Device and Printer screen
eg "Microsoft XPS Document Writer", "%laser%".
.TP
.B
DELAY
(optional) specifies the number of seconds over which the utilisation is calculated. The longer you can make this without timing out, the more accurate it will be. If specifying longer values. You may also need to use the \fB-t\fP parameter to set a longer script timeout. Only valid if also specifying \fB--nokeepstate\fP ie you are not using the state keeping feature. We recommend that you do keep state and hence do not use \fB--nokeepstate\fP. Default is 5.
.TP
.B
WARN/CRIT
can be used for this MODE. You need to specify a field name if not using the Default field eg \fB-w\fP FIELD=VALUE or simply \fB-w\fP VALUE for the Default field. Valid Warning/Critical Fields are: _BytesPrintedPersec (Default), JobErrors, Jobs, JobsSpooling, NotReadyErrors, OutofPaperErrors, TotalJobsPrinted, TotalPagesPrinted
.RE
.TP
.B
checkproc, cmdline (\fB-m\fP checkproc \fB-s\fP cmdline)
An ini implementation similar to checkprocess. 
.RS
.TP
.B
ARG1
The exact command line to search for. Use / instead of \\.
e.g. C:/WINDOWS/system32/services.exe.
.TP
.B
Note:
Use \fB--nodatamode\fP and/or NODATAEXIT settings to control what happens if no matching process is found.
.TP
.B
WARN/CRIT
can be used for this MODE. You need to specify a field name if not using the Default field eg \fB-w\fP FIELD=VALUE or simply \fB-w\fP VALUE for the Default field. Valid Warning/Critical Fields are: _ItemCount (Default)
.RE
.TP
.B
checkproc, count (\fB-m\fP checkproc \fB-s\fP count)
Check number of processes.
.RS
.TP
.B
ARG1
The processname to look for. Use % for wildcards.
The process name typically only includes the actual file name minus its suffix eg firefox, svchost
If there are multiple instances eg svchost, then some versions of Windows have them named all the same while others
such as Windows 2008 Server, have them numbered eg svchost#1, svchost#2, svchost#3. To get all svchost processes you
need to set ARG1 to svchost%
To view all processes set ARG1 to "%" and the full process list will be included in the plugin output.
.TP
.B
Note:
Use \fB--nodatamode\fP and/or NODATAEXIT settings to control what happens if no matching process is found.
.TP
.B
WARN/CRIT
can be used for this MODE. You need to specify a field name if not using the Default field eg \fB-w\fP FIELD=VALUE or simply \fB-w\fP VALUE for the Default field. Valid Warning/Critical Fields are: _ItemCount (Default)
.RE
.TP
.B
checkproc, cpu (\fB-m\fP checkproc \fB-s\fP cpu)
Check cpu details for individual processes
.RS
.TP
.B
ARG1
The processname to look for. Use % for wildcards.
The process name typically only includes the actual file name minus its suffix eg firefox, svchost
If there are multiple instances eg svchost, then some versions of Windows have them named all the same while others
such as Windows 2008 Server, have them numbered eg svchost#1, svchost#2, svchost#3. To get all svchost processes you
need to set ARG1 to svchost%
To view all processes set ARG1 to "%" and the full process list will be included in the plugin output.
.TP
.B
Note:
Use \fB--nodatamode\fP and/or NODATAEXIT settings to control what happens if no matching process is found.
.TP
.B
DELAY
(optional) specifies the number of seconds over which the utilisation is calculated. The longer you can make this without timing out, the more accurate it will be. If specifying longer values. You may also need to use the \fB-t\fP parameter to set a longer script timeout. Only valid if also specifying \fB--nokeepstate\fP ie you are not using the state keeping feature. We recommend that you do keep state and hence do not use \fB--nokeepstate\fP. Default is 5.
.TP
.B
WARN/CRIT
can be used for this MODE. You need to specify a field name if not using the Default field eg \fB-w\fP FIELD=VALUE or simply \fB-w\fP VALUE for the Default field. Valid Warning/Critical Fields are: _AvgCPU (Default), _ItemCount
.RE
.TP
.B
checkproc, cpuabove (\fB-m\fP checkproc \fB-s\fP cpuabove)
Check for processes using more than a specified CPU utilisation. To make this work as intended you need to specify some
warning/critical criteria eg \fB-w\fP 50 for warning when a process uses more than 50% CPU. You probably also want to remove 
all processes with low CPU from the results. Do this using something like \fB-exc\fP _AvgCPU=@0:5 (which will exclude processes that have CPU utilisation between 0 and 5%)
.RS
.TP
.B
ARG1
The processname to look for. Use % for wildcards.
The process name typically only includes the actual file name minus its suffix eg firefox, svchost
If there are multiple instances eg svchost, then some versions of Windows have them named all the same while others
such as Windows 2008 Server, have them numbered eg svchost#1, svchost#2, svchost#3. To get all svchost processes you
need to set ARG1 to svchost%
To view all processes set ARG1 to "%" and the full process list will be included in the plugin output.
.TP
.B
Note:
Use \fB--nodatamode\fP and/or NODATAEXIT settings to control what happens if no matching process is found.
.TP
.B
DELAY
(optional) specifies the number of seconds over which the utilisation is calculated. The longer you can make this without timing out, the more accurate it will be. If specifying longer values. You may also need to use the \fB-t\fP parameter to set a longer script timeout. Only valid if also specifying \fB--nokeepstate\fP ie you are not using the state keeping feature. We recommend that you do keep state and hence do not use \fB--nokeepstate\fP. Default is 5.
.TP
.B
WARN/CRIT
can be used for this MODE. You need to specify a field name if not using the Default field eg \fB-w\fP FIELD=VALUE or simply \fB-w\fP VALUE for the Default field. Valid Warning/Critical Fields are: _AvgCPU (Default), _ItemCount
.RE
.TP
.B
checkproc, info (\fB-m\fP checkproc \fB-s\fP info)
Check process attributes eg file handles, page faults etc 
You might like to read the documentation for the WMI Class that this query uses to understand the attributes that can be checked.
Refer to http://msdn.microsoft.com/en-us/library/aa394372%28v=vs.85%29.
This check contains a lot of data so you probably want to restrict to to a minimal list of processes.
.RS
.TP
.B
ARG1
The processname to look for. Use % for wildcards.
The process name typically only includes the actual file name minus its suffix eg firefox, svchost
If there are multiple instances eg svchost, then some versions of Windows have them named all the same while others
such as Windows 2008 Server, have them numbered eg svchost#1, svchost#2, svchost#3. To get all svchost processes you
need to set ARG1 to svchost%
To view all processes set ARG1 to "%" and the full process list will be included in the plugin output.
.TP
.B
Note:
Use \fB--nodatamode\fP and/or NODATAEXIT settings to control what happens if no matching process is found.
.TP
.B
WARN/CRIT
can be used for this MODE. You need to specify a field name if not using the Default field eg \fB-w\fP FIELD=VALUE or simply \fB-w\fP VALUE for the Default field. Valid Warning/Critical Fields are: _ItemCount (Default), HandleCount, _KernelModeTime, MaximumWorkingSetSize, MinimumWorkingSetSize, PageFaults, PageFileUsage, PeakPageFileUsage, PeakVirtualSize, PeakWorkingSetSize, Priority, PrivatePageCount, ReadOperationCount, ReadTransferCount, ThreadCount, _UserModeTime, VirtualSize, WorkingSetSize, WriteOperationCount, WriteTransferCount
.RE
.TP
.B
checkproc, memory (\fB-m\fP checkproc \fB-s\fP memory)
Check memory details for individual processes showing individual process details.
.RS
.TP
.B
ARG1
The processname to look for. Use % for wildcards.
The process name typically only includes the actual file name minus its suffix eg firefox, svchost
If there are multiple instances eg svchost, then some versions of Windows have them named all the same while others
such as Windows 2008 Server, have them numbered eg svchost#1, svchost#2, svchost#3. To get all svchost processes you
need to set ARG1 to svchost%
To view all processes set ARG1 to "%" and the full process list will be included in the plugin output.
.TP
.B
Note:
Use \fB--nodatamode\fP and/or NODATAEXIT settings to control what happens if no matching process is found.
.TP
.B
WARN/CRIT
can be used for this MODE. You need to specify a field name if not using the Default field eg \fB-w\fP FIELD=VALUE or simply \fB-w\fP VALUE for the Default field. Valid Warning/Critical Fields are: _ItemCount (Default), PrivateBytes, WorkingSet, VirtualBytes
.RE
.TP
.B
checkproc, memoryabove (\fB-m\fP checkproc \fB-s\fP memoryabove)
Check for processes using more that a specified amount of memory. To make this work as intended you need to specify some
warning/critical criteria eg \fB-w\fP WorkingSet=50M for warning when a process uses more than 50M of WorkingSet memory. You probably also want to remove 
all processes with memory lower than the warning level. Do this using something like \fB-exc\fP WorkingSet=@0:40M (which will exclude processes that have a WorkingSet between 0 and 40M). We could have made that \fB-exc\fP WorkingSet=@0:50M but then the check will only show processes when there are some to warn against. That might be what you want. Instead of WorkingSet, you can also use PrivateBytes or VirtualBytes. You can in fact use more than one of them at the same time if you wish eg \fB-exc\fP WorkingSet=@0:50M \fB-exc\fP VirtualBytes=@0:50M.
.RS
.TP
.B
ARG1
The processname to look for. Use % for wildcards.
The process name typically only includes the actual file name minus its suffix eg firefox, svchost
If there are multiple instances eg svchost, then some versions of Windows have them named all the same while others
such as Windows 2008 Server, have them numbered eg svchost#1, svchost#2, svchost#3. To get all svchost processes you
need to set ARG1 to svchost%
To view all processes set ARG1 to "%" and the full process list will be included in the plugin output.
.TP
.B
Note:
Use \fB--nodatamode\fP and/or NODATAEXIT settings to control what happens if no matching process is found.
.TP
.B
WARN/CRIT
can be used for this MODE. You need to specify a field name if not using the Default field eg \fB-w\fP FIELD=VALUE or simply \fB-w\fP VALUE for the Default field. Valid Warning/Critical Fields are: _ItemCount (Default), PrivateBytes, WorkingSet, VirtualBytes
.RE
.TP
.B
checkproc, memorytotals (\fB-m\fP checkproc \fB-s\fP memorytotals)
Check memory details for individual processes and show memory totals.
.RS
.TP
.B
ARG1
The processname to look for. Use % for wildcards.
The process name typically only includes the actual file name minus its suffix eg firefox, svchost
If there are multiple instances eg svchost, then some versions of Windows have them named all the same while others
such as Windows 2008 Server, have them numbered eg svchost#1, svchost#2, svchost#3. To get all svchost processes you
need to set ARG1 to svchost%
To view all processes set ARG1 to "%" and the full process list will be included in the plugin output.
.TP
.B
Note:
Use \fB--nodatamode\fP and/or NODATAEXIT settings to control what happens if no matching process is found.
.TP
.B
WARN/CRIT
can be used for this MODE. You need to specify a field name if not using the Default field eg \fB-w\fP FIELD=VALUE or simply \fB-w\fP VALUE for the Default field. Valid Warning/Critical Fields are: _ItemCount (Default), _ColSum_PrivateBytes, _ColSum_WorkingSet, _ColSum_VirtualBytes
.RE
.TP
.B
checkserv, byname (\fB-m\fP checkserv \fB-s\fP byname)
An ini implementation similar to checkservice. This uses a WMI query that may perform faster on busy systems.
.RS
.TP
.B
ARG1
The DisplayName or Name of the service to search for. Use % for wildcards.
.TP
.B
Note:
Use \fB--nodatamode\fP and/or NODATAEXIT settings to control what happens if no matching process is found.
.TP
.B
WARN/CRIT
can be used for this MODE. You need to specify a field name if not using the Default field eg \fB-w\fP FIELD=VALUE or simply \fB-w\fP VALUE for the Default field. Valid Warning/Critical Fields are: _ItemCount (Default)
.RE
.TP
.B
checksql, buffermanager (\fB-m\fP checksql \fB-s\fP buffermanager)
Check SQL Server Buffer Manager. Tested for Microsoft SQL Server 2008.
.RS
.TP
.B
ARG1
(optional) Specify an non-default SQL Instance Name. You actually specify part of the WMI Class name but see below for more info. The default setting for this is MSSQLSERVER_SQLSERVER. If you specify this as "default" then the default value will be used. This can simplify your Nagios configuration by allowing you to have a single commmand definition.
.TP
.B
Selecting an Instance:
The WMI Class name is built up from the SQL instance name. For the default SQL Instance name, part of the WMI Class is MSSQLSERVER_SQLSERVER. For SQL Express the part of the WMI Class is MSSQLSQLEXPRESS_MSSQLSQLEXPRESS.
If you have an installation that uses a different SQL Instance name you'll have to work out the WMI Class Name and use that. Typically, if the SQL Instance is XXX then the WMI Class will be MSSQLXXX_MSSQLXXX. If you find a problem with this mapping please contact us.
.TP
.B
Examples:
To select the default SQL Express Instance use \fB-a\fP MSSQLSQLEXPRESS_MSSQLSQLEXPRESS.
To select a non-default SQL Instance called XXX use \fB-a\fP MSSQLXXX_MSSQLXXX.
.TP
.B
DELAY
(optional) specifies the number of seconds over which the utilisation is calculated. The longer you can make this without timing out, the more accurate it will be. If specifying longer values. You may also need to use the \fB-t\fP parameter to set a longer script timeout. Only valid if also specifying \fB--nokeepstate\fP ie you are not using the state keeping feature. We recommend that you do keep state and hence do not use \fB--nokeepstate\fP. Default is 5.
.TP
.B
WARN/CRIT
can be used for this MODE. You need to specify a field name if not using the Default field eg \fB-w\fP FIELD=VALUE or simply \fB-w\fP VALUE for the Default field. Valid Warning/Critical Fields are: Buffercachehitratio (Default), _CheckpointpagesPersec, Databasepages, _FreeliststallsPersec, Freepages, _LazywritesPersec, Pagelifeexpectancy, _PagelookupsPersec, _PagereadsPersec, _PagewritesPersec, _ReadaheadpagesPersec, Reservedpages, Stolenpages, Targetpages, Totalpages
.RE
.TP
.B
checksql, cache (\fB-m\fP checksql \fB-s\fP cache)
SQL Server Cache Statistics. Tested for Microsoft SQL Server 2008. Only tested on a low volume server.
.RS
.TP
.B
ARG1
(optional) Specify an non-default SQL Instance Name. You actually specify part of the WMI Class name but see below for more info. The default setting for this is MSSQLSERVER_SQLSERVER. If you specify this as "default" then the default value will be used. This can simplify your Nagios configuration by allowing you to have a single commmand definition.
.TP
.B
Selecting an Instance:
The WMI Class name is built up from the SQL instance name. For the default SQL Instance name, part of the WMI Class is MSSQLSERVER_SQLSERVER. For SQL Express the part of the WMI Class is MSSQLSQLEXPRESS_MSSQLSQLEXPRESS.
If you have an installation that uses a different SQL Instance name you'll have to work out the WMI Class Name and use that. Typically, if the SQL Instance is XXX then the WMI Class will be MSSQLXXX_MSSQLXXX. If you find a problem with this mapping please contact us.
.TP
.B
Examples:
To select the default SQL Express Instance use \fB-a\fP MSSQLSQLEXPRESS_MSSQLSQLEXPRESS.
To select a non-default SQL Instance called XXX use \fB-a\fP MSSQLXXX_MSSQLXXX.
.TP
.B
WARN/CRIT
can be used for this MODE. You need to specify a field name if not using the Default field eg \fB-w\fP FIELD=VALUE or simply \fB-w\fP VALUE for the Default field. Valid Warning/Critical Fields are: CacheHitRatio (Default), CacheObjectCounts, CacheObjectsinuse, CachePages
.RE
.TP
.B
checksql, general (\fB-m\fP checksql \fB-s\fP general)
General SQL Server Statistics. Tested for Microsoft SQL Server 2008. Only tested on a low volume server.
.RS
.TP
.B
ARG1
(optional) Specify an non-default SQL Instance Name. You actually specify part of the WMI Class name but see below for more info. The default setting for this is MSSQLSERVER_SQLSERVER. If you specify this as "default" then the default value will be used. This can simplify your Nagios configuration by allowing you to have a single commmand definition.
.TP
.B
Selecting an Instance:
The WMI Class name is built up from the SQL instance name. For the default SQL Instance name, part of the WMI Class is MSSQLSERVER_SQLSERVER. For SQL Express the part of the WMI Class is MSSQLSQLEXPRESS_MSSQLSQLEXPRESS.
If you have an installation that uses a different SQL Instance name you'll have to work out the WMI Class Name and use that. Typically, if the SQL Instance is XXX then the WMI Class will be MSSQLXXX_MSSQLXXX. If you find a problem with this mapping please contact us.
.TP
.B
Examples:
To select the default SQL Express Instance use \fB-a\fP MSSQLSQLEXPRESS_MSSQLSQLEXPRESS.
To select a non-default SQL Instance called XXX use \fB-a\fP MSSQLXXX_MSSQLXXX.
.TP
.B
DELAY
(optional) specifies the number of seconds over which the utilisation is calculated. The longer you can make this without timing out, the more accurate it will be. If specifying longer values. You may also need to use the \fB-t\fP parameter to set a longer script timeout. Only valid if also specifying \fB--nokeepstate\fP ie you are not using the state keeping feature. We recommend that you do keep state and hence do not use \fB--nokeepstate\fP. Default is 5.
.TP
.B
WARN/CRIT
can be used for this MODE. You need to specify a field name if not using the Default field eg \fB-w\fP FIELD=VALUE or simply \fB-w\fP VALUE for the Default field. Valid Warning/Critical Fields are: ActiveTempTables (Default), _LoginsPersec, _LogoutsPersec, LogicalConnections, Processesblocked, _TempTablesCreationRate, UserConnections
.RE
.TP
.B
checksql, latches (\fB-m\fP checksql \fB-s\fP latches)
SQL Server Latch and SuperLatch Statistics. Tested for Microsoft SQL Server 2008. Only tested on a low volume server.
.RS
.TP
.B
ARG1
(optional) Specify an non-default SQL Instance Name. You actually specify part of the WMI Class name but see below for more info. The default setting for this is MSSQLSERVER_SQLSERVER. If you specify this as "default" then the default value will be used. This can simplify your Nagios configuration by allowing you to have a single commmand definition.
.TP
.B
Selecting an Instance:
The WMI Class name is built up from the SQL instance name. For the default SQL Instance name, part of the WMI Class is MSSQLSERVER_SQLSERVER. For SQL Express the part of the WMI Class is MSSQLSQLEXPRESS_MSSQLSQLEXPRESS.
If you have an installation that uses a different SQL Instance name you'll have to work out the WMI Class Name and use that. Typically, if the SQL Instance is XXX then the WMI Class will be MSSQLXXX_MSSQLXXX. If you find a problem with this mapping please contact us.
.TP
.B
Examples:
To select the default SQL Express Instance use \fB-a\fP MSSQLSQLEXPRESS_MSSQLSQLEXPRESS.
To select a non-default SQL Instance called XXX use \fB-a\fP MSSQLXXX_MSSQLXXX.
.TP
.B
DELAY
(optional) specifies the number of seconds over which the utilisation is calculated. The longer you can make this without timing out, the more accurate it will be. If specifying longer values. You may also need to use the \fB-t\fP parameter to set a longer script timeout. Only valid if also specifying \fB--nokeepstate\fP ie you are not using the state keeping feature. We recommend that you do keep state and hence do not use \fB--nokeepstate\fP. Default is 5.
.TP
.B
WARN/CRIT
can be used for this MODE. You need to specify a field name if not using the Default field eg \fB-w\fP FIELD=VALUE or simply \fB-w\fP VALUE for the Default field. Valid Warning/Critical Fields are: AverageLatchWaitTimems (Default), _LatchWaitsPersec, NumberofSuperLatches, _SuperLatchDemotionsPersec, _SuperLatchPromotionsPersec, TotalLatchWaitTimems
.RE
.TP
.B
checksql, listcache (\fB-m\fP checksql \fB-s\fP listcache)
List all cache types in a SQL Server instance. This is just a helper check.
.RS
.TP
.B
ARG1
(optional) Specify an non-default SQL Instance Name. You actually specify part of the WMI Class name but see below for more info. The default setting for this is MSSQLSERVER_SQLSERVER. If you specify this as "default" then the default value will be used. This can simplify your Nagios configuration by allowing you to have a single commmand definition.
.TP
.B
Selecting an Instance:
The WMI Class name is built up from the SQL instance name. For the default SQL Instance name, part of the WMI Class is MSSQLSERVER_SQLSERVER. For SQL Express the part of the WMI Class is MSSQLSQLEXPRESS_MSSQLSQLEXPRESS.
If you have an installation that uses a different SQL Instance name you'll have to work out the WMI Class Name and use that. Typically, if the SQL Instance is XXX then the WMI Class will be MSSQLXXX_MSSQLXXX. If you find a problem with this mapping please contact us.
.TP
.B
Examples:
To select the default SQL Express Instance use \fB-a\fP MSSQLSQLEXPRESS_MSSQLSQLEXPRESS.
To select a non-default SQL Instance called XXX use \fB-a\fP MSSQLXXX_MSSQLXXX.
.TP
.B
WARN/CRIT
Not used for this MODE.
.RE
.TP
.B
checksql, listdb (\fB-m\fP checksql \fB-s\fP listdb)
List all DBs in a SQL Server database. This is just a helper check.
.RS
.TP
.B
ARG1
(optional) Specify an non-default SQL Instance Name. You actually specify part of the WMI Class name but see below for more info. The default setting for this is MSSQLSERVER_SQLSERVER. If you specify this as "default" then the default value will be used. This can simplify your Nagios configuration by allowing you to have a single commmand definition.
.TP
.B
Selecting an Instance:
The WMI Class name is built up from the SQL instance name. For the default SQL Instance name, part of the WMI Class is MSSQLSERVER_SQLSERVER. For SQL Express the part of the WMI Class is MSSQLSQLEXPRESS_MSSQLSQLEXPRESS.
If you have an installation that uses a different SQL Instance name you'll have to work out the WMI Class Name and use that. Typically, if the SQL Instance is XXX then the WMI Class will be MSSQLXXX_MSSQLXXX. If you find a problem with this mapping please contact us.
.TP
.B
Examples:
To select the default SQL Express Instance use \fB-a\fP MSSQLSQLEXPRESS_MSSQLSQLEXPRESS.
To select a non-default SQL Instance called XXX use \fB-a\fP MSSQLXXX_MSSQLXXX.
.TP
.B
WARN/CRIT
can be used for this MODE. You need to specify a field name if not using the Default field eg \fB-w\fP FIELD=VALUE or simply \fB-w\fP VALUE for the Default field. Valid Warning/Critical Fields are: _ItemCount (Default)
.RE
.TP
.B
checksql, listlocks (\fB-m\fP checksql \fB-s\fP listlocks)
List all lock types in a SQL Server instance. This is just a helper check.
.RS
.TP
.B
ARG1
(optional) Specify an non-default SQL Instance Name. You actually specify part of the WMI Class name but see below for more info. The default setting for this is MSSQLSERVER_SQLSERVER. If you specify this as "default" then the default value will be used. This can simplify your Nagios configuration by allowing you to have a single commmand definition.
.TP
.B
Selecting an Instance:
The WMI Class name is built up from the SQL instance name. For the default SQL Instance name, part of the WMI Class is MSSQLSERVER_SQLSERVER. For SQL Express the part of the WMI Class is MSSQLSQLEXPRESS_MSSQLSQLEXPRESS.
If you have an installation that uses a different SQL Instance name you'll have to work out the WMI Class Name and use that. Typically, if the SQL Instance is XXX then the WMI Class will be MSSQLXXX_MSSQLXXX. If you find a problem with this mapping please contact us.
.TP
.B
Examples:
To select the default SQL Express Instance use \fB-a\fP MSSQLSQLEXPRESS_MSSQLSQLEXPRESS.
To select a non-default SQL Instance called XXX use \fB-a\fP MSSQLXXX_MSSQLXXX.
.TP
.B
WARN/CRIT
Not used for this MODE.
.RE
.TP
.B
checksql, locks (\fB-m\fP checksql \fB-s\fP locks)
SQL Server Lock Statistics. Tested for Microsoft SQL Server 2008. Only tested on a low volume server.
.RS
.TP
.B
ARG1
(optional) Specify an non-default SQL Instance Name. You actually specify part of the WMI Class name but see below for more info. The default setting for this is MSSQLSERVER_SQLSERVER. If you specify this as "default" then the default value will be used. This can simplify your Nagios configuration by allowing you to have a single commmand definition.
.TP
.B
Selecting an Instance:
The WMI Class name is built up from the SQL instance name. For the default SQL Instance name, part of the WMI Class is MSSQLSERVER_SQLSERVER. For SQL Express the part of the WMI Class is MSSQLSQLEXPRESS_MSSQLSQLEXPRESS.
If you have an installation that uses a different SQL Instance name you'll have to work out the WMI Class Name and use that. Typically, if the SQL Instance is XXX then the WMI Class will be MSSQLXXX_MSSQLXXX. If you find a problem with this mapping please contact us.
.TP
.B
Examples:
To select the default SQL Express Instance use \fB-a\fP MSSQLSQLEXPRESS_MSSQLSQLEXPRESS.
To select a non-default SQL Instance called XXX use \fB-a\fP MSSQLXXX_MSSQLXXX.
.TP
.B
DELAY
(optional) specifies the number of seconds over which the utilisation is calculated. The longer you can make this without timing out, the more accurate it will be. If specifying longer values. You may also need to use the \fB-t\fP parameter to set a longer script timeout. Only valid if also specifying \fB--nokeepstate\fP ie you are not using the state keeping feature. We recommend that you do keep state and hence do not use \fB--nokeepstate\fP. Default is 5.
.TP
.B
WARN/CRIT
can be used for this MODE. You need to specify a field name if not using the Default field eg \fB-w\fP FIELD=VALUE or simply \fB-w\fP VALUE for the Default field. Valid Warning/Critical Fields are: AverageWaitTimems (Default), _LockRequestsPersec, _LockTimeoutstimeout0Persec, _LockWaitsPersec, LockWaitTimems, _NumberofDeadlocksPersec
.RE
.TP
.B
checksql, memory (\fB-m\fP checksql \fB-s\fP memory)
SQL Server Memory Statistics. Tested for Microsoft SQL Server 2008. Only tested on a low volume server.
.RS
.TP
.B
ARG1
(optional) Specify an non-default SQL Instance Name. You actually specify part of the WMI Class name but see below for more info. The default setting for this is MSSQLSERVER_SQLSERVER. If you specify this as "default" then the default value will be used. This can simplify your Nagios configuration by allowing you to have a single commmand definition.
.TP
.B
Selecting an Instance:
The WMI Class name is built up from the SQL instance name. For the default SQL Instance name, part of the WMI Class is MSSQLSERVER_SQLSERVER. For SQL Express the part of the WMI Class is MSSQLSQLEXPRESS_MSSQLSQLEXPRESS.
If you have an installation that uses a different SQL Instance name you'll have to work out the WMI Class Name and use that. Typically, if the SQL Instance is XXX then the WMI Class will be MSSQLXXX_MSSQLXXX. If you find a problem with this mapping please contact us.
.TP
.B
Examples:
To select the default SQL Express Instance use \fB-a\fP MSSQLSQLEXPRESS_MSSQLSQLEXPRESS.
To select a non-default SQL Instance called XXX use \fB-a\fP MSSQLXXX_MSSQLXXX.
.TP
.B
WARN/CRIT
can be used for this MODE. You need to specify a field name if not using the Default field eg \fB-w\fP FIELD=VALUE or simply \fB-w\fP VALUE for the Default field. Valid Warning/Critical Fields are: _ConnectionMemory (Default), LockBlocks, LockBlocksAllocated, _LockMemory, LockOwnerBlocks, LockOwnerBlocksAllocated, _MaximumWorkspaceMemory, MemoryGrantsOutstanding, MemoryGrantsPending, _OptimizerMemory, _SQLCacheMemory, _TargetServerMemory, _TotalServerMemory
.RE
.TP
.B
checksql, sqlstats (\fB-m\fP checksql \fB-s\fP sqlstats)
SQL Server SQL Statistics. Tested for Microsoft SQL Server 2008. Only tested on a low volume server.
.RS
.TP
.B
ARG1
(optional) Specify an non-default SQL Instance Name. You actually specify part of the WMI Class name but see below for more info. The default setting for this is MSSQLSERVER_SQLSERVER. If you specify this as "default" then the default value will be used. This can simplify your Nagios configuration by allowing you to have a single commmand definition.
.TP
.B
Selecting an Instance:
The WMI Class name is built up from the SQL instance name. For the default SQL Instance name, part of the WMI Class is MSSQLSERVER_SQLSERVER. For SQL Express the part of the WMI Class is MSSQLSQLEXPRESS_MSSQLSQLEXPRESS.
If you have an installation that uses a different SQL Instance name you'll have to work out the WMI Class Name and use that. Typically, if the SQL Instance is XXX then the WMI Class will be MSSQLXXX_MSSQLXXX. If you find a problem with this mapping please contact us.
.TP
.B
Examples:
To select the default SQL Express Instance use \fB-a\fP MSSQLSQLEXPRESS_MSSQLSQLEXPRESS.
To select a non-default SQL Instance called XXX use \fB-a\fP MSSQLXXX_MSSQLXXX.
.TP
.B
DELAY
(optional) specifies the number of seconds over which the utilisation is calculated. The longer you can make this without timing out, the more accurate it will be. If specifying longer values. You may also need to use the \fB-t\fP parameter to set a longer script timeout. Only valid if also specifying \fB--nokeepstate\fP ie you are not using the state keeping feature. We recommend that you do keep state and hence do not use \fB--nokeepstate\fP. Default is 5.
.TP
.B
WARN/CRIT
can be used for this MODE. You need to specify a field name if not using the Default field eg \fB-w\fP FIELD=VALUE or simply \fB-w\fP VALUE for the Default field. Valid Warning/Critical Fields are: _BatchRequestsPersec (Default), _FailedAutoParamsPersec, _ForcedParameterizationsPersec, _GuidedplanexecutionsPersec, _MisguidedplanexecutionsPersec, _SafeAutoParamsPersec, _SQLAttentionrate, _SQLCompilationsPersec, _SQLReCompilationsPersec, _UnsafeAutoParamsPersec
.RE
.TP
.B
checksql, waits (\fB-m\fP checksql \fB-s\fP waits)
SQL Server Wait Statistics. This only shows Average Wait time in milliseconds. You could modify this check to show other wait types eg Waits in Progress. Tested for Microsoft SQL Server 2008. Only tested on a low volume server.
.RS
.TP
.B
ARG1
(optional) Specify an non-default SQL Instance Name. You actually specify part of the WMI Class name but see below for more info. The default setting for this is MSSQLSERVER_SQLSERVER. If you specify this as "default" then the default value will be used. This can simplify your Nagios configuration by allowing you to have a single commmand definition.
.TP
.B
Selecting an Instance:
The WMI Class name is built up from the SQL instance name. For the default SQL Instance name, part of the WMI Class is MSSQLSERVER_SQLSERVER. For SQL Express the part of the WMI Class is MSSQLSQLEXPRESS_MSSQLSQLEXPRESS.
If you have an installation that uses a different SQL Instance name you'll have to work out the WMI Class Name and use that. Typically, if the SQL Instance is XXX then the WMI Class will be MSSQLXXX_MSSQLXXX. If you find a problem with this mapping please contact us.
.TP
.B
Examples:
To select the default SQL Express Instance use \fB-a\fP MSSQLSQLEXPRESS_MSSQLSQLEXPRESS.
To select a non-default SQL Instance called XXX use \fB-a\fP MSSQLXXX_MSSQLXXX.
.TP
.B
WARN/CRIT
can be used for this MODE. You need to specify a field name if not using the Default field eg \fB-w\fP FIELD=VALUE or simply \fB-w\fP VALUE for the Default field. Valid Warning/Critical Fields are: Lockwaits (Default), Logbufferwaits, Logwritewaits, Memorygrantqueuewaits, NetworkIOwaits, NonPagelatchwaits, PageIOlatchwaits, Pagelatchwaits, Threadsafememoryobjectswaits, Transactionownershipwaits, Waitfortheworker, Workspacesynchronizationwaits
.RE
.TP
.B
checkts, sessioninfo (\fB-m\fP checkts \fB-s\fP sessioninfo)
Check Terminal Services Session Info for specific sessions.
.RS
.TP
.B
ARG1
Name of the TS Session eg console
Note: Not tested on a real terminal services server - you might need to play with this to get what you need.
You can find the session names using the check MODE=checkts SUBMODE=show
.TP
.B
DELAY
(optional) specifies the number of seconds over which the utilisation is calculated. The longer you can make this without timing out, the more accurate it will be. If specifying longer values. You may also need to use the \fB-t\fP parameter to set a longer script timeout. Only valid if also specifying \fB--nokeepstate\fP ie you are not using the state keeping feature. We recommend that you do keep state and hence do not use \fB--nokeepstate\fP. Default is 5.
.TP
.B
WARN/CRIT
can be used for this MODE. You need to specify a field name if not using the Default field eg \fB-w\fP FIELD=VALUE or simply \fB-w\fP VALUE for the Default field. Valid Warning/Critical Fields are: _InputBytes (Default), _InputCompressedBytes, InputErrors, InputTimeouts, _OutputBytes, _OutputCompressedBytes, OutputErrors, OutputTimeouts, _PercentProcessorTime, PrivateBytes, ThreadCount, _TotalBytes, TotalErrors, TotalTimeouts
.RE
.TP
.B
checkts, sessions (\fB-m\fP checkts \fB-s\fP sessions)
Check Terminal Services Sessions.
Tested for Windows Server 2008.
.RS
.TP
.B
WARN/CRIT
can be used for this MODE. You need to specify a field name if not using the Default field eg \fB-w\fP FIELD=VALUE or simply \fB-w\fP VALUE for the Default field. Valid Warning/Critical Fields are: ActiveSessions (Default), InactiveSessions, TotalSessions
.RE
.TP
.B
checkts, sessions2003 (\fB-m\fP checkts \fB-s\fP sessions2003)
Check Terminal Services Sessions.
Tested for Windows 2003, Windows XP.
.RS
.TP
.B
WARN/CRIT
can be used for this MODE. You need to specify a field name if not using the Default field eg \fB-w\fP FIELD=VALUE or simply \fB-w\fP VALUE for the Default field. Valid Warning/Critical Fields are: ActiveSessions (Default), InactiveSessions, TotalSessions
.RE
.TP
.B
checkts, show (\fB-m\fP checkts \fB-s\fP show)
Show current Terminal Services Session names. Use this check, normally from the command line, to list the 
curent session names. Session names are then used in other checkts checks.
.RS
.TP
.B
WARN/CRIT
Not used for this MODE.
.RE
.TP
.B
info, cpu (\fB-m\fP info \fB-s\fP cpu)
This check shows basic cpu information.
.RS
.TP
.B
WARN/CRIT
Not used for this MODE.
.RE
.TP
.B
info, listsoftware2003 (\fB-m\fP info \fB-s\fP listsoftware2003)
Lists all the instances of software installed. Used during testing/debuging/helping others.
Gives a lot of output!
Works for XP, Server 2003 and Server 2008.
You are better off using listsoftware2008 if you can.
.RS
.TP
.B
WARN/CRIT
Not used for this MODE.
.RE
.TP
.B
info, listsoftware2008 (\fB-m\fP info \fB-s\fP listsoftware2008)
Lists all the instances of software installed which used an Installer. Used during testing/debuging/helping others.
Gives a lot of output!
Works for XP, Server 2008.
This is probably the best software lister (as it list software at a Product level) if it works for your OS version.
.RS
.TP
.B
WARN/CRIT
Not used for this MODE.
.RE
.TP
.B
info, listsoftwarefeatures2008 (\fB-m\fP info \fB-s\fP listsoftwarefeatures2008)
Lists all the instances of software installed. Used during testing/debuging/helping others.
Gives a lot of output!
Works for XP, Server 2008.
This will add a lot of bits that listsoftware2008 will miss.
.RS
.TP
.B
WARN/CRIT
Not used for this MODE.
.RE
.TP
.B
info, net (\fB-m\fP info \fB-s\fP net)
This check shows basic networking information (sometimes includes duplicate information).
Looks OK in Nagios with multi-line plugin output and not so good on the command line!
.RS
.TP
.B
WARN/CRIT
Not used for this MODE.
.RE
.TP
.B
info, os (\fB-m\fP info \fB-s\fP os)
This check shows the Operating System Name and Service Pack version.
It also shows the Installation Date timestamp and age in days.
You can check warn/critical against the age of the Installation Date. The warn/critical specification should be in seconds.
Use the time multipliers to make this simpler. See the section "WARNING and CRITICAL Specification".
eg \fB-w\fP 2yr to test if the installation is older than 2 years.
.RS
.TP
.B
WARN/CRIT
can be used for this MODE. You need to specify a field name if not using the Default field eg \fB-w\fP FIELD=VALUE or simply \fB-w\fP VALUE for the Default field. Valid Warning/Critical Fields are: _InstallSec (Default)
.RE
.TP
.B
sample, full (\fB-m\fP sample \fB-s\fP full)
Help for a sample check that specifies all currently possible fields in the ini File.
.RS
.TP
.B
WARN/CRIT
can be used for this MODE. You need to specify a field name if not using the Default field eg \fB-w\fP FIELD=VALUE or simply \fB-w\fP VALUE for the Default field. Valid Warning/Critical Fields are: NumberOfProcesses (Default), NumberOfUsers, _FreeMemPercent
.RE
.TP
.B
sample, minimal (\fB-m\fP sample \fB-s\fP minimal)
Help for a sample check that specifies only a minimal amount of configuration in the ini File.
This sample simply displays the Name of the Operating System and Service Pack version.
It has no warning/critical specification and provides no performance data.
.RS
.TP
.B
WARN/CRIT
Not used for this MODE.
.RE
.TP
.B
sample, uptime (\fB-m\fP sample \fB-s\fP uptime)
Help for a sample check that is similar to checkuptime. This one is somewhat simpler and uses seconds.
.RS
.TP
.B
WARN/CRIT
can be used for this MODE. You need to specify a field name if not using the Default field eg \fB-w\fP FIELD=VALUE or simply \fB-w\fP VALUE for the Default field. Valid Warning/Critical Fields are: _UptimeSec (Default)
.RE
.TP
.B
test, 1 (\fB-m\fP test \fB-s\fP 1)
Just for testing
.RS
.TP
.B
DELAY
(optional) specifies the number of seconds over which the utilisation is calculated. The longer you can make this without timing out, the more accurate it will be. If specifying longer values. You may also need to use the \fB-t\fP parameter to set a longer script timeout. Only valid if also specifying \fB--nokeepstate\fP ie you are not using the state keeping feature. We recommend that you do keep state and hence do not use \fB--nokeepstate\fP. Default is 5.
.TP
.B
WARN/CRIT
can be used for this MODE. You need to specify a field name if not using the Default field eg \fB-w\fP FIELD=VALUE or simply \fB-w\fP VALUE for the Default field. Valid Warning/Critical Fields are: _AvgCPU (Default)
.RE
.TP
.B
test, 2 (\fB-m\fP test \fB-s\fP 2)
Just for testing
.RS
.TP
.B
DELAY
(optional) specifies the number of seconds over which the utilisation is calculated. The longer you can make this without timing out, the more accurate it will be. If specifying longer values. You may also need to use the \fB-t\fP parameter to set a longer script timeout. Only valid if also specifying \fB--nokeepstate\fP ie you are not using the state keeping feature. We recommend that you do keep state and hence do not use \fB--nokeepstate\fP. Default is 5.
.TP
.B
WARN/CRIT
can be used for this MODE. You need to specify a field name if not using the Default field eg \fB-w\fP FIELD=VALUE or simply \fB-w\fP VALUE for the Default field. Valid Warning/Critical Fields are: _AvgCPU (Default), _NoCPU, NoSuchField
.RE
.TP
.B
test, 3 (\fB-m\fP test \fB-s\fP 3)
Just for testing
.RS
.TP
.B
DELAY
(optional) specifies the number of seconds over which the utilisation is calculated. The longer you can make this without timing out, the more accurate it will be. If specifying longer values. You may also need to use the \fB-t\fP parameter to set a longer script timeout. Only valid if also specifying \fB--nokeepstate\fP ie you are not using the state keeping feature. We recommend that you do keep state and hence do not use \fB--nokeepstate\fP. Default is 5.
.TP
.B
WARN/CRIT
can be used for this MODE. You need to specify a field name if not using the Default field eg \fB-w\fP FIELD=VALUE or simply \fB-w\fP VALUE for the Default field. Valid Warning/Critical Fields are: _AvgCPU (Default), _ItemCount
.RE
.TP
.B
test, 4 (\fB-m\fP test \fB-s\fP 4)
Just for testing
.RS
.TP
.B
WARN/CRIT
Not used for this MODE.
